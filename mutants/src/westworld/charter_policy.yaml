# Anti-Delos Charter Policy Specification
# Version: 1.0.0
# Enforces user privacy and data rights across the mesh network

charter:
  version: "1.0.0"
  effective_date: "2026-01-11"
  name: "x0tta6bl4 Data Rights Charter"
  organization: "x0tta6bl4 Community"
  
  # Metadata for governance
  metadata:
    charter_id: "xotta-charter-001"
    author: "Data Audit Committee"
    last_updated: "2026-01-11"
    status: "active"  # active | pending | deprecated | suspended
    emergency_contacts:
      - email: "privacy@x0tta6bl4.local"
      - slack: "#data-rights"

# Whitelist of ALLOWED metrics that nodes can collect
# Everything not listed here is FORBIDDEN
whitelisted_metrics:
  
  # Network health metrics (ALLOWED)
  network:
    - metric_name: "latency_p50"
      description: "50th percentile latency (milliseconds)"
      access_level: "public"
      retention_days: 30
      
    - metric_name: "latency_p95"
      description: "95th percentile latency"
      access_level: "public"
      retention_days: 30
      
    - metric_name: "latency_p99"
      description: "99th percentile latency"
      access_level: "public"
      retention_days: 30
      
    - metric_name: "packet_loss_percent"
      description: "Percentage of packets lost"
      access_level: "public"
      retention_days: 7
      
    - metric_name: "throughput_mbps"
      description: "Network throughput (Mbps)"
      access_level: "public"
      retention_days: 30
      
    - metric_name: "connection_uptime_percent"
      description: "Percentage of time connection is up"
      access_level: "public"
      retention_days: 90

  # Infrastructure metrics (ALLOWED)
  infrastructure:
    - metric_name: "cpu_usage_percent"
      description: "CPU usage (0-100%)"
      access_level: "node_operator_only"
      retention_days: 30
      
    - metric_name: "memory_usage_percent"
      description: "Memory usage (0-100%)"
      access_level: "node_operator_only"
      retention_days: 30
      
    - metric_name: "disk_usage_percent"
      description: "Disk usage (0-100%)"
      access_level: "node_operator_only"
      retention_days: 30
      
    - metric_name: "network_interface_status"
      description: "Status: up/down/degraded"
      access_level: "node_operator_only"
      retention_days: 90

  # Service-level metrics (ALLOWED)
  service:
    - metric_name: "api_requests_per_second"
      description: "API requests per second (aggregated)"
      access_level: "public"
      retention_days: 7
      
    - metric_name: "error_rate_percent"
      description: "Percentage of failed requests"
      access_level: "public"
      retention_days: 7
      
    - metric_name: "service_version"
      description: "Version of running service"
      access_level: "public"
      retention_days: 1000

# FORBIDDEN metrics (explicit blacklist)
# These MUST NEVER be collected
forbidden_metrics:
  - metric_name: "user_location"
    description: "GPS coordinates, IP geolocation, any location data"
    reason: "Privacy violation - activist safety risk"
    penalty: "CRITICAL"
    
  - metric_name: "user_identity"
    description: "Node owner name, email, phone, personal info"
    reason: "Privacy violation - de-anonymization risk"
    penalty: "CRITICAL"
    
  - metric_name: "browsing_history"
    description: "URLs visited, content accessed, user behavior"
    reason: "Privacy violation - surveillance"
    penalty: "CRITICAL"
    
  - metric_name: "device_hardware_id"
    description: "MAC address, serial numbers, hardware fingerprints"
    reason: "Device tracking - activist safety risk"
    penalty: "HIGH"
    
  - metric_name: "user_communication_metadata"
    description: "Message sizes, recipient counts, timing patterns"
    reason: "Metadata can reveal identities and relationships"
    penalty: "HIGH"
    
  - metric_name: "system_logs_with_user_data"
    description: "Logs containing usernames, email addresses, content"
    reason: "May leak sensitive information"
    penalty: "HIGH"

# Access control policies
access_control:
  
  # Who can READ metrics
  read_access:
    - role: "public"
      description: "Anyone on the network"
      access: "all_public_metrics"
      requirements: []
      
    - role: "node_operator"
      description: "Operator of a specific node"
      access: "node_operator_only + all_public_metrics"
      requirements:
        - "owns_node"
        - "valid_mTLS_cert"
        
    - role: "audit_committee_member"
      description: "Member of data audit committee"
      access: "all_metrics_except_user_id"
      requirements:
        - "DAO_vote_approval"
        - "2FA_enabled"
        - "background_check_passed"
        
    - role: "emergency_responder"
      description: "Responding to privacy violation emergency"
      access: "all_metrics"
      requirements:
        - "DAO_emergency_vote_5min"
        - "auto_revoke_after_24h"
        - "full_audit_trail"

  # Who can WRITE metrics (collect data)
  write_access:
    - role: "node_operator"
      description: "Can only collect whitelisted metrics from own node"
      write_to: "whitelisted_metrics"
      requirements:
        - "signed_charter_agreement"
        - "valid_node_certificate"
        
    - role: "approved_service"
      description: "Service approved by DAO for metric collection"
      write_to: "service_specific_whitelist"
      requirements:
        - "DAO_approval"
        - "quarterly_DAO_renewal"
        - "public_service_audit"

# Violation policies
violation_policy:
  
  # Detect unauthorized metric collection
  detection_method: "eBPF kernel hooks + userspace proxy"
  
  # What happens when violation detected
  response:
    level_1_warning:
      threshold: "first_violation"
      action: "log_and_notify_audit_committee"
      penalty: "warning"
      
    level_2_access_denied:
      threshold: "2nd_violation_within_30_days"
      action: "block_metric_collection"
      penalty: "temporary_service_suspension_24h"
      
    level_3_node_isolation:
      threshold: "3rd_violation_within_30_days"
      action: "quarantine_node_from_network"
      penalty: "DAO_vote_required_for_restoration"
      
    level_4_legal_escalation:
      threshold: "pattern_of_violations"
      action: "report_to_legal_team"
      penalty: "potential_legal_action"
  
  # Audit trail (immutable)
  audit_trail:
    enabled: true
    storage: "IPFS + local_ledger"
    retention: "permanent"
    encrypted: true
    signing: "Ed25519"

# Whistleblower protection
whistleblower_policy:
  protection_enabled: true
  anonymous_reporting: true
  report_channels:
    - channel: "privacy_hotline"
      contact: "privacy@x0tta6bl4.local"
      response_time_sla: "24_hours"
    - channel: "secure_form"
      url: "https://privacy.x0tta6bl4.local/report"
      tor_available: true
    - channel: "encrypted_email"
      pgp_key: "privacy@x0tta6bl4.local"
  bounty_pool: true
  bounty_amount_usd: 1000  # Reward for valid violation reports

# Emergency override (requires DAO vote)
emergency_override:
  enabled: false  # Only enable with explicit DAO vote
  reason: null
  authorized_by: null
  expires_at: null
  requires_DAO_renewal_every_hours: 2
  full_audit_trail_required: true

# Charter enforcement
enforcement:
  
  # Metric validation
  validation:
    enabled: true
    strict_mode: true  # Deny by default, whitelist explicitly
    validation_latency_ms: "< 10ms"  # Must not impact performance
    
  # Kernel-level enforcement (Phase 2+)
  kernel_enforcement:
    enabled: false  # Disabled in Phase 0, enabled Phase 2+
    method: "eBPF"
    namespace: "x0tta6bl4_charter"
    
  # Observability
  observability:
    prometheus_export: true
    prometheus_port: 9090
    grafana_dashboard: "charter_enforcement"
    alerting_enabled: true
    alert_on_violations: true

# Success criteria
success_criteria:
  - "100% of network traffic validated against charter"
  - "Zero unauthorized metric collection detected in 30-day period"
  - "All violations logged to immutable audit trail"
  - "Audit committee can view all violations within 5 minutes"
  - "Emergency access possible within 30 minutes (DAO vote)"
  - "Whistleblower reports processed within 24 hours"

# Changelog
changelog:
  - version: "1.0.0"
    date: "2026-01-11"
    changes:
      - "Initial charter: 20 whitelisted metrics, 6 forbidden metrics"
      - "Four access control roles defined"
      - "Violation response policy with 4 severity levels"
      - "Whistleblower protection and bounty system"
      - "Emergency override with 2-hour renewal requirement"
