apiVersion: v1
kind: ConfigMap
metadata:
  name: batman-adv-audit-policy
  namespace: kube-system
  labels:
    app: audit
    component: batman-adv
data:
  audit-policy.yaml: |
    apiVersion: audit.k8s.io/v1
    kind: Policy
    rules:
    - level: RequestResponse
      omitStages: ["RequestReceived"]
      namespaces: ["mesh-network"]
      resources:
      - group: ""
        resources: ["pods"]
      verbs: ["create", "update", "patch", "delete"]
    - level: Metadata
      namespaces: ["mesh-network"]
      resources:
      - group: ""
        resources: ["pods/exec"]
