# üîí –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ ML –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

**–ü—Ä–æ–±–ª–µ–º–∞:** –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–æ–ª–Ω–æ–π –≤–µ—Ä—Å–∏–∏ PyTorch —Å CUDA –º–æ–∂–µ—Ç –∑–∞–≤–∏—Å–Ω—É—Ç—å —Å–∏—Å—Ç–µ–º—É –∏–∑-–∑–∞ –±–æ–ª—å—à–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –ø–∞–∫–µ—Ç–æ–≤ (~2-3 GB).

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CPU-only –≤–µ—Ä—Å–∏–∏ PyTorch –∏ –ø–æ—à–∞–≥–æ–≤–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏.

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
# –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ (CPU-only, –ø–æ—à–∞–≥–æ–≤–∞—è)
bash scripts/install_ledger_ml_deps_safe.sh
```

---

## üìã –ß—Ç–æ –¥–µ–ª–∞–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç

1. **–ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã** (–ø–∞–º—è—Ç—å)
2. **–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø–æ—à–∞–≥–æ–≤–æ:**
   - numpy (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
   - hnswlib (–ª–µ–≥–∫–∏–π –ø–∞–∫–µ—Ç)
   - PyTorch CPU-only (–∏–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–≥–æ –∏–Ω–¥–µ–∫—Å–∞)
   - sentence-transformers (–ø–æ—Å–ª–µ PyTorch)
3. **–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–∞–∂–¥—É—é —É—Å—Ç–∞–Ω–æ–≤–∫—É** –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ—Ö–æ–¥–æ–º –∫ —Å–ª–µ–¥—É—é—â–µ–π
4. **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç `--no-cache-dir`** –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ –º–µ—Å—Ç–∞

---

## ‚öôÔ∏è –û—Ç–ª–∏—á–∏—è –æ—Ç –æ–±—ã—á–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–±—ã—á–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ | –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ |
|----------|-------------------|---------------------|
| PyTorch | –° CUDA (~2-3 GB) | CPU-only (~200 MB) |
| –£—Å—Ç–∞–Ω–æ–≤–∫–∞ | –í—Å–µ —Å—Ä–∞–∑—É | –ü–æ—à–∞–≥–æ–≤–∞—è |
| –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤ | –ù–µ—Ç | –î–∞ |
| –í—Ä–µ–º—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ | 10-20 –º–∏–Ω | 5-10 –º–∏–Ω |
| –†–∏—Å–∫ –∑–∞–≤–∏—Å–∞–Ω–∏—è | –í—ã—Å–æ–∫–∏–π | –ù–∏–∑–∫–∏–π |

---

## üéØ –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±–µ–∑–æ–ø–∞—Å–Ω—É—é —É—Å—Ç–∞–Ω–æ–≤–∫—É –µ—Å–ª–∏:
- –°–∏—Å—Ç–µ–º–∞ –∑–∞–≤–∏—Å–∞–ª–∞ –ø—Ä–∏ –ø—Ä–µ–¥—ã–¥—É—â–µ–π —É—Å—Ç–∞–Ω–æ–≤–∫–µ
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è –ø–∞–º—è—Ç—å (<4 GB —Å–≤–æ–±–æ–¥–Ω–æ–π)
- –ù–µ –Ω—É–∂–Ω–∞ GPU –ø–æ–¥–¥–µ—Ä–∂–∫–∞
- –ù—É–∂–Ω–∞ –±—ã—Å—Ç—Ä–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

### ‚ö†Ô∏è –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–±—ã—á–Ω—É—é —É—Å—Ç–∞–Ω–æ–≤–∫—É –µ—Å–ª–∏:
- –ï—Å—Ç—å GPU –∏ –Ω—É–∂–Ω–∞ CUDA –ø–æ–¥–¥–µ—Ä–∂–∫–∞
- –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ä–µ—Å—É—Ä—Å–æ–≤ (8+ GB RAM)
- –ù—É–∂–Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

---

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

```bash
source venv/bin/activate
python scripts/check_ledger_ml_deps.py
```

–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
```
‚úÖ –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –∏ —Ä–∞–±–æ—Ç–∞—é—Ç
‚úÖ PyTorch: CPU-only –≤–µ—Ä—Å–∏—è
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
source venv/bin/activate

# –ë–∞–∑–æ–≤—ã–π —Ç–µ—Å—Ç
python -c "import torch; print('PyTorch:', torch.__version__, 'CPU-only:', not torch.cuda.is_available())"

# –¢–µ—Å—Ç RAG
python scripts/index_ledger_in_rag.py
python scripts/ledger_rag_query.py "–ö–∞–∫–∏–µ –º–µ—Ç—Ä–∏–∫–∏?"
```

---

## üîÑ –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ GPU –≤–µ—Ä—Å–∏—é (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–ï—Å–ª–∏ –ø–æ–∑–∂–µ –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è GPU –ø–æ–¥–¥–µ—Ä–∂–∫–∞:

```bash
source venv/bin/activate

# –£–¥–∞–ª–∏—Ç—å CPU-only –≤–µ—Ä—Å–∏—é
pip uninstall torch torchvision torchaudio

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å CUDA –≤–µ—Ä—Å–∏—é (–∑–∞–º–µ–Ω–∏—Ç–µ cu121 –Ω–∞ –≤–∞—à—É –≤–µ—Ä—Å–∏—é CUDA)
pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu121
```

---

## üêõ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ –µ—â–µ –∑–∞–≤–∏—Å–∞–µ—Ç

**–†–µ—à–µ–Ω–∏–µ 1:** –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–∞–∫–µ—Ç—ã –ø–æ –æ–¥–Ω–æ–º—É –≤—Ä—É—á–Ω—É—é:
```bash
source venv/bin/activate
pip install --no-cache-dir numpy
pip install --no-cache-dir hnswlib
pip install --no-cache-dir --index-url https://download.pytorch.org/whl/cpu torch
pip install --no-cache-dir sentence-transformers
```

**–†–µ—à–µ–Ω–∏–µ 2:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤:
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º –ø–∞–º—è—Ç–∏ (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ)
nice -n 19 bash scripts/install_ledger_ml_deps_safe.sh
```

### –ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∞ "externally-managed-environment"

**–†–µ—à–µ–Ω–∏–µ:** –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–æ:
```bash
source venv/bin/activate
which python  # –î–æ–ª–∂–µ–Ω —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ venv/bin/python
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–µ—Å—Ç–∞ –Ω–∞ –¥–∏—Å–∫–µ

**–†–µ—à–µ–Ω–∏–µ:** –û—á–∏—Å—Ç–∏—Ç–µ –∫–µ—à pip:
```bash
pip cache purge
```

---

## üìä –†–∞–∑–º–µ—Ä —É—Å—Ç–∞–Ω–æ–≤–∫–∏

- **CPU-only PyTorch:** ~200 MB
- **sentence-transformers:** ~100 MB
- **hnswlib:** ~5 MB
- **numpy:** ~20 MB
- **–ú–æ–¥–µ–ª–∏ (–∫–µ—à):** ~500 MB (–ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏)
- **–ò—Ç–æ–≥–æ:** ~825 MB (vs ~3 GB –¥–ª—è CUDA –≤–µ—Ä—Å–∏–∏)

---

## ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ CPU-only –≤–µ—Ä—Å–∏–∏

1. ‚úÖ –ë—ã—Å—Ç—Ä–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ (5-10 –º–∏–Ω vs 15-30 –º–∏–Ω)
2. ‚úÖ –ú–µ–Ω—å—à–µ –º–µ—Å—Ç–∞ –Ω–∞ –¥–∏—Å–∫–µ (~800 MB vs ~3 GB)
3. ‚úÖ –ù–µ—Ç –ø—Ä–æ–±–ª–µ–º —Å CUDA –¥—Ä–∞–π–≤–µ—Ä–∞–º–∏
4. ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –ª—é–±–æ–π —Å–∏—Å—Ç–µ–º–µ
5. ‚úÖ –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è semantic search (–Ω–µ —Ç—Ä–µ–±—É–µ—Ç GPU)

---

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –î–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –∑–∞–¥–∞—á semantic search CPU –≤–µ—Ä—Å–∏—è PyTorch –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞. GPU –Ω—É–∂–Ω–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π –∏–ª–∏ –æ—á–µ–Ω—å –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤ –¥–∞–Ω–Ω—ã—Ö.

