# CVE-2020-12812: –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è –∑–∞—â–∏—Ç–∞ x0tta6bl4

**–î–∞—Ç–∞:** 30 –Ω–æ—è–±—Ä—è 2025  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–º —É—Ä–æ–≤–Ω–µ

---

## üéØ –°—É—Ç—å —É—è–∑–≤–∏–º–æ—Å—Ç–∏

CVE-2020-12812 –≤ FortiGate –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫—É—é –ø—Ä–æ–±–ª–µ–º—É: **–Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞ –º–µ–∂–¥—É —Å–∏—Å—Ç–µ–º–∞–º–∏ —Å–æ–∑–¥–∞—ë—Ç –æ–±—Ö–æ–¥—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—è –Ω–µ –º–æ–∂–µ—Ç –∏—Å–ø—Ä–∞–≤–∏—Ç—å**.

### –ú–µ—Ö–∞–Ω–∏–∑–º –∞—Ç–∞–∫–∏ FortiGate

```
–õ–µ–≥–∏—Ç–∏–º–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: "jsmith" + 2FA ‚Üí –ó–∞–ø—Ä–æ—Å —Ç–æ–∫–µ–Ω–∞ ‚úì
–í—Ö–æ–¥ –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–∞: "Jsmith" ‚Üí –õ–æ–∫–∞–ª—å–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ
‚Üí –û—Ç–∫–∞—Ç –∫ LDAP –≥—Ä—É–ø–ø–µ
LDAP —Å–µ—Ä–≤–µ—Ä: –ù–µ—á—É–≤—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –∫ —Ä–µ–≥–∏—Å—Ç—Ä—É ‚Üí "Jsmith" = "jsmith" 
‚Üí Auth —É—Å–ø–µ—à–Ω–∞ –ë–ï–ó 2FA ‚úó
```

**–ö–æ—Ä–Ω–µ–≤–∞—è –ø—Ä–∏—á–∏–Ω–∞:** FortiGate (case-sensitive) vs LDAP (case-insensitive) = –æ–±—Ö–æ–¥ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.

---

## ‚úÖ –†–µ—à–µ–Ω–∏–µ x0tta6bl4

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

> **–í—Å–µ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã –≤ x0tta6bl4 –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –Ω–∏–∂–Ω–∏–π —Ä–µ–≥–∏—Å—Ç—Ä.**

–≠—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ ‚Äî —ç—Ç–æ **–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏**, —É—Å—Ç—Ä–∞–Ω—è—é—â–µ–µ —Ü–µ–ª—ã–π –∫–ª–∞—Å—Å –∞—Ç–∞–∫ –Ω–∞ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é.

### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

**–ú–æ–¥—É–ª—å:** `src/security/identity_normalization.py`

```python
def normalize_identity(identifier: str) -> Tuple[bytes, str]:
    """–ö–∞–Ω–æ–Ω–∏—á–µ—Å–∫–∞—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è: —Ç–æ–ª—å–∫–æ –Ω–∏–∂–Ω–∏–π —Ä–µ–≥–∏—Å—Ç—Ä"""
    canonical = identifier.lower().strip()
    identity_token = hashlib.sha256(canonical.encode()).digest()
    return identity_token, canonical

def enforce_lowercase_rule(identifier: str) -> str:
    """Fail-closed: –æ—Ç–∫–ª–æ–Ω—è–µ—Ç –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã —Å –∑–∞–≥–ª–∞–≤–Ω—ã–º–∏ –±—É–∫–≤–∞–º–∏"""
    if identifier != identifier.lower():
        raise ValueError("CVE-2020-12812 protection: uppercase not allowed")
    return identifier.lower().strip()
```

### –ì–∞—Ä–∞–Ω—Ç–∏–∏

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –†–∏—Å–∫ FortiGate | –ó–∞—â–∏—Ç–∞ x0tta6bl4 | –°—Ç–∞—Ç—É—Å |
|---|---|---|---|
| **–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç–∏** | –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π (–Ω–µ—Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞) | –¢–æ–ª—å–∫–æ –Ω–∏–∂–Ω–∏–π —Ä–µ–≥–∏—Å—Ç—Ä | ‚úÖ |
| **–°–∫—Ä—ã—Ç—ã–µ –æ—Ç–∫–∞—Ç—ã** | –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π (LDAP fallback) | Fail-closed, –±–µ–∑ –æ—Ç–∫–∞—Ç–æ–≤ | ‚úÖ |
| **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –¥—Ä–µ–π—Ñ** | –í—ã—Å–æ–∫–∏–π (5 –ª–µ—Ç —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏) | MAPE-K –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å | ‚úÖ |
| **Post-quantum –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—è** | –£—è–∑–≤–∏–º–∞ (RSA/ECDSA) | ML-KEM-768, ML-DSA-65 | ‚úÖ |

---

## üîí –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≤ –∫–æ–¥–µ

### 1. –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –≤—Ö–æ–¥–µ

```python
from src.security.identity_normalization import enforce_lowercase_rule

def authenticate_node(node_id: str):
    # Fail-closed: –æ—Ç–∫–ª–æ–Ω—è–µ—Ç "MyNode", "ADMIN", "NodeID"
    normalized_id = enforce_lowercase_rule(node_id, context="node_auth")
    # ... –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è –ø—Ä–∏–≤—è–∑–∫–∞ –∫ normalized_id
```

### 2. –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è –ø—Ä–∏–≤—è–∑–∫–∞

```python
from src.security.identity_normalization import normalize_identity

def bind_identity_to_key(identifier: str, public_key: bytes):
    # –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç: "jsmith", "Jsmith", "JSMITH" ‚Üí –æ–¥–∏–Ω —Ç–æ–∫–µ–Ω
    identity_token, canonical = normalize_identity(identifier)
    # –ü—Ä–∏–≤—è–∑–∫–∞ –∫ –∫–ª—é—á—É –∏—Å–ø–æ–ª—å–∑—É–µ—Ç identity_token
    return bind_key(identity_token, public_key)
```

### 3. MAPE-K –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

```python
def monitor_identity_compliance():
    """–û–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç –ø–æ–ø—ã—Ç–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∑–∞–≥–ª–∞–≤–Ω—ã—Ö –±—É–∫–≤"""
    for node_id in active_nodes:
        if node_id != node_id.lower():
            logger.warning(f"‚ö†Ô∏è CVE-2020-12812 IoC: uppercase in '{node_id}'")
            quarantine_node(node_id)
```

---

## üìã –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã

**–°–∏—Å—Ç–µ–º–Ω—ã–µ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã (—Ç–æ–ª—å–∫–æ –Ω–∏–∂–Ω–∏–π —Ä–µ–≥–∏—Å—Ç—Ä):**
- `x0tta6bl4` ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Å–∏—Å—Ç–µ–º—ã
- `hip3.14cirz` ‚Äî –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä

**–ü—Ä–∞–≤–∏–ª–æ:** –õ—é–±—ã–µ –≤–∞—Ä–∏–∞—Ü–∏–∏ (`X0TTA6BL4`, `X0tta6bl4`) –æ—Ç–∫–ª–æ–Ω—è—é—Ç—Å—è –Ω–∞ –≤—Ö–æ–¥–µ.

---

## üö® –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏ (IoCs)

–ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –¥–∞–∂–µ –±–µ–∑ LDAP:

| –°–∏–≥–Ω–∞–ª | –î–µ–π—Å—Ç–≤–∏–µ |
|--------|---------|
| –ü–æ–ø—ã—Ç–∫–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å–æ —Å–º–µ—à–∞–Ω–Ω—ã–º —Ä–µ–≥–∏—Å—Ç—Ä–æ–º | Alert + throttle |
| –£—Å–ø–µ—à–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ—Å–ª–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è | Log + quarantine |
| –ò–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏, –æ—Ç–∫–ª—é—á–∞—é—â–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏—é | Rollback + alert |
| –ù–µ–ø—Ä–µ–¥–≤–∏–¥–µ–Ω–Ω—ã–µ —É–∑–ª—ã —Å –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º–∏ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞–º–∏ | Quarantine |

---

## üîÑ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å LDAP (–µ—Å–ª–∏ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è)

**–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û:** –ï—Å–ª–∏ x0tta6bl4 –∫–æ–≥–¥–∞-–ª–∏–±–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç LDAP:

1. **–û—Ç–¥–µ–ª—å–Ω—ã–π –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—ã–π –∫–æ–Ω–≤–µ–π–µ—Ä** (–±–µ–∑ –Ω–µ—è–≤–Ω—ã—Ö –æ—Ç–∫–∞—Ç–æ–≤)
2. **–í—Å–µ LDAP –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã ‚Üí –Ω–∏–∂–Ω–∏–π —Ä–µ–≥–∏—Å—Ç—Ä** –ø–µ—Ä–µ–¥ –ø—Ä–∏–≤—è–∑–∫–æ–π –∫ mesh
3. **–ê–ª–µ—Ä—Ç—ã –Ω–µ—Å–æ–≤–ø–∞–¥–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏** ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∫–∞—Ä–∞–Ω—Ç–∏–Ω —É–∑–ª–∞
4. **–Ø–≤–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è** –ø–æ –∫–∞–∂–¥–æ–π LDAP –∑–∞–ø–∏—Å–∏ (–±–µ–∑ –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–æ—á–Ω—ã—Ö –≥—Ä—É–ø–ø–æ–≤—ã—Ö –¥–æ—Å—Ç—É–ø–æ–≤)

```python
def ldap_authenticate(username: str):
    # –ö–†–ò–¢–ò–ß–ù–û: –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ–º –î–û –ª—é–±–æ–π –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏
    _, canonical = normalize_identity(username)
    
    # LDAP lookup –∏—Å–ø–æ–ª—å–∑—É–µ—Ç canonical
    ldap_user = ldap_client.find(canonical)
    
    # –ù–µ—Ç –æ—Ç–∫–∞—Ç–∞ –∫ –≥—Ä—É–ø–ø–æ–≤–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
    if not ldap_user:
        raise AuthenticationError("User not found")
    
    # –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è –ø—Ä–∏–≤—è–∑–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç canonical
    return bind_to_mesh(canonical, ldap_user.public_key)
```

---

## üìä –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç

| –î–∞—Ç–∞ | –°–æ–±—ã—Ç–∏–µ | –°—Ç–∞—Ç—É—Å |
|---|---|---|
| –ò—é–ª—å 2020 | –ò—Å—Ö–æ–¥–Ω—ã–π –ø–∞—Ç—á FortiGate | ‚úì |
| –ê–ø—Ä–µ–ª—å 2021 | FBI/CISA –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ç–∏–≤–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç | ‚ö†Ô∏è |
| –ú–∞–π 2022 | COBALT MIRAGE –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–ª—è lateral movement | üî¥ |
| –î–µ–∫–∞–±—Ä—å 2024 | Fortinet –Ω–∞–±–ª—é–¥–∞–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ–µ –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ | üî¥ |
| **30 –Ω–æ—è–±—Ä—è 2025** | **x0tta6bl4 –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è –∑–∞—â–∏—Ç–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞** | ‚úÖ |

---

## üéØ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**CVE-2020-12812 –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:** –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –º–µ–∂–¥—É –ø—Ä–æ—Ç–æ–∫–æ–ª–∞–º–∏ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å–æ–∑–¥–∞—ë—Ç –æ–±—Ö–æ–¥—ã, –∫–æ—Ç–æ—Ä—ã–µ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—è –Ω–µ –º–æ–∂–µ—Ç –∏—Å–ø—Ä–∞–≤–∏—Ç—å.

**x0tta6bl4 —Ä–µ—à–∞–µ—Ç —ç—Ç–æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ:**
- ‚úÖ –ö–∞–Ω–æ–Ω–∏—á–µ—Å–∫–∞—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ –≥—Ä–∞–Ω–∏—Ü–µ –≤–≤–æ–¥–∞
- ‚úÖ Fail-closed –ø–æ–¥—Ö–æ–¥ (–Ω–µ—Ç –Ω–µ—è–≤–Ω—ã—Ö –æ—Ç–∫–∞—Ç–æ–≤)
- ‚úÖ –ù–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è (MAPE-K)
- ‚úÖ Post-quantum –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—è (ML-KEM-768, ML-DSA-65)

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** x0tta6bl4 –∑–∞—â–∏—â—ë–Ω –æ—Ç —Ü–µ–ª–æ–≥–æ –∫–ª–∞—Å—Å–∞ –∞—Ç–∞–∫ –Ω–∞ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é, –≤–∫–ª—é—á–∞—è CVE-2020-12812 –∏ –µ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç—ã.

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞—â–∏—Ç–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π  
**–û–±–Ω–æ–≤–ª–µ–Ω–æ:** 30 –Ω–æ—è–±—Ä—è 2025

