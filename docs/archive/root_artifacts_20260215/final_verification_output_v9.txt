============================= test session starts ==============================
platform linux -- Python 3.12.3, pytest-8.4.2, pluggy-1.6.0 -- /usr/bin/python3
cachedir: .pytest_cache
benchmark: 5.1.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)
hypothesis profile 'default' -> database=DirectoryBasedExampleDatabase(PosixPath('/mnt/projects/.hypothesis/examples'))
rootdir: /mnt/projects
configfile: pyproject.toml
plugins: asyncio-1.2.0, cov-7.0.0, xdist-3.8.0, anyio-4.12.0, mock-3.12.0, benchmark-5.1.0, hypothesis-6.98.15
asyncio: mode=Mode.STRICT, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collecting ... collected 26 items

tests/test_ebpf_integration.py::TestEBPFIntegration::test_loader_orchestrator_integration PASSED [  3%]
tests/test_ebpf_integration.py::TestEBPFIntegration::test_orchestrator_lifecycle_management PASSED [  7%]
tests/test_ebpf_integration.py::TestEBPFIntegration::test_cli_loader_integration PASSED [ 11%]
tests/test_ebpf_integration.py::TestEBPFIntegration::test_full_system_integration FAILED [ 15%]
tests/test_ebpf_integration.py::TestEBPFIntegration::test_error_handling_integration PASSED [ 19%]
tests/test_ebpf_integration.py::TestEBPFIntegration::test_performance_monitoring_integration PASSED [ 23%]
tests/test_ebpf_integration.py::TestEBPFIntegration::test_configuration_persistence PASSED [ 26%]
tests/test_pqc_integration.py::TestEBPFPQCGateway::test_create_session PASSED [ 30%]
tests/test_pqc_integration.py::TestEBPFPQCGateway::test_get_session PASSED [ 34%]
tests/test_pqc_integration.py::TestEBPFPQCGateway::test_rotate_session_keys PASSED [ 38%]
tests/test_pqc_integration.py::TestEBPFPQCGateway::test_encrypt_decrypt_payload PASSED [ 42%]
tests/test_pqc_integration.py::TestEBPFPQCGateway::test_get_ebpf_map_data PASSED [ 46%]
tests/test_pqc_integration.py::TestPQCXDPLoader::test_loader_initialization PASSED [ 50%]
tests/test_pqc_integration.py::TestPQCXDPLoader::test_update_pqc_sessions PASSED [ 53%]
tests/test_pqc_integration.py::TestPQCXDPLoader::test_get_pqc_stats PASSED [ 57%]
tests/test_pqc_integration.py::TestPQCZeroTrustHealer::test_monitor_healthy_system PASSED [ 61%]
tests/test_pqc_integration.py::TestPQCZeroTrustHealer::test_analyze_no_issues PASSED [ 65%]
tests/test_pqc_integration.py::TestPQCZeroTrustHealer::test_plan_no_action PASSED [ 69%]
tests/test_pqc_integration.py::TestPQCZeroTrustHealer::test_execute_empty_plan PASSED [ 73%]
tests/test_pqc_integration.py::TestPQCZeroTrustHealer::test_anomaly_detection PASSED [ 76%]
tests/test_pqc_integration.py::TestPQCZeroTrustHealer::test_health_score_calculation PASSED [ 80%]
tests/test_pqc_integration.py::TestPQCZeroTrustHealer::test_cleanup_expired_sessions PASSED [ 84%]
tests/test_pqc_integration.py::TestPQCZeroTrustHealer::test_rotate_expired_sessions PASSED [ 88%]
tests/test_pqc_integration.py::TestPQCSessionAnomaly::test_anomaly_creation PASSED [ 92%]
tests/test_pqc_integration.py::TestIntegration::test_full_healing_cycle PASSED [ 96%]
tests/test_pqc_integration.py::TestIntegration::test_gateway_loader_integration PASSED [100%]/home/x0ttta6bl4/.local/lib/python3.12/site-packages/coverage/report_core.py:107: CoverageWarning: Couldn't parse Python file '/mnt/projects/src/network/обновление_алгоритмов.py' (couldnt-parse); see https://coverage.readthedocs.io/en/7.13.0/messages.html#warning-couldnt-parse
  coverage._warn(msg, slug="couldnt-parse")

ERROR: Coverage failure: total of 4 is less than fail-under=75


=================================== FAILURES ===================================
_______________ TestEBPFIntegration.test_full_system_integration _______________
tests/test_ebpf_integration.py:179: in test_full_system_integration
    assert isinstance(program_id, str)
E   assert False
E    +  where False = isinstance(None, str)
------------------------------ Captured log call -------------------------------
WARNING  src.network.ebpf.performance_monitor:performance_monitor.py:168 Prometheus not available, skipping metric: ebpf_packets_processed_total
WARNING  src.network.ebpf.performance_monitor:performance_monitor.py:168 Prometheus not available, skipping metric: ebpf_packets_dropped_total
WARNING  src.network.ebpf.performance_monitor:performance_monitor.py:168 Prometheus not available, skipping metric: ebpf_processing_latency_microseconds
WARNING  src.network.ebpf.performance_monitor:performance_monitor.py:168 Prometheus not available, skipping metric: ebpf_cpu_usage_percent
WARNING  src.network.ebpf.performance_monitor:performance_monitor.py:168 Prometheus not available, skipping metric: ebpf_memory_usage_bytes
WARNING  src.network.ebpf.performance_monitor:performance_monitor.py:168 Prometheus not available, skipping metric: ebpf_flows_active
WARNING  src.network.ebpf.performance_monitor:performance_monitor.py:168 Prometheus not available, skipping metric: ebpf_errors_total
WARNING  src.network.ebpf.performance_monitor:performance_monitor.py:168 Prometheus not available, skipping metric: ebpf_program_load_time_seconds
ERROR    src.network.ebpf.orchestrator:orchestrator.py:586 Failed to load program: eBPF program not found: /tmp/tmpt81y811u/test_xdp.o
WARNING  src.network.ebpf.performance_monitor:performance_monitor.py:356 Alert generated: {'title': 'WARNING: Memory usage', 'message': 'Value 50586470.987630494 exceeds warning threshold 50000000', 'severity': 'warning', 'timestamp': 1770541815.228416, 'source': 'ebpf_performance_monitor'}
----------------- generated xml file: /mnt/projects/junit.xml ------------------
================================ tests coverage ================================
_______________ coverage: platform linux, python 3.12.3-final-0 ________________

Coverage HTML written to dir htmlcov
Coverage XML written to file coverage.xml
FAIL Required test coverage of 75% not reached. Total coverage: 3.66%
=========================== short test summary info ============================
FAILED tests/test_ebpf_integration.py::TestEBPFIntegration::test_full_system_integration - assert False
 +  where False = isinstance(None, str)
======================== 1 failed, 25 passed in 33.54s =========================
