# üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ ML –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –¥–ª—è Continuity Ledger

**–î–∞—Ç–∞:** 2026-01-03  
**–í–µ—Ä—Å–∏—è:** Phase 1 (RAG Integration)  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –°–∫—Ä–∏–ø—Ç—ã –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –≥–æ—Ç–æ–≤—ã

---

## üìä –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

### ‚úÖ –°–æ–∑–¥–∞–Ω–æ

1. **requirements-ledger-ml.txt** ‚Äî —Ñ–∞–π–ª —Å ML –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏
2. **scripts/install_ledger_ml_deps.sh** ‚Äî —Å–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏
3. **scripts/check_ledger_ml_deps.py** ‚Äî —Å–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
4. **docs/LEDGER_ML_DEPS_INSTALL.md** ‚Äî –ø–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### ‚ö†Ô∏è –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–∫–∞–∑–∞–ª–∞:**
- ‚ùå hnswlib: –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- ‚ùå sentence-transformers: –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- ‚úÖ VectorIndex: –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è (fallback —Ä–µ–∂–∏–º)
- ‚úÖ RAGPipeline: –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è (fallback —Ä–µ–∂–∏–º)
- ‚úÖ LedgerRAGSearch: –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è (fallback —Ä–µ–∂–∏–º)

**–í—ã–≤–æ–¥:** –ë–∞–∑–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç –≤ fallback —Ä–µ–∂–∏–º–µ, –Ω–æ –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ semantic search –Ω—É–∂–Ω—ã –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏.

---

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### –ë—ã—Å—Ç—Ä–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
bash scripts/install_ledger_ml_deps.sh
```

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç Python –∏ pip
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç —É—Å—Ç–∞–Ω–æ–≤–∫—É
4. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–µ—Ç –∏–º–ø–æ—Ä—Ç—ã

### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ —Å–ø–æ—Å–æ–±—ã

```bash
# –ß–µ—Ä–µ–∑ requirements —Ñ–∞–π–ª
pip install -r requirements-ledger-ml.txt

# –ü—Ä—è–º–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞
pip install hnswlib sentence-transformers

# –ß–µ—Ä–µ–∑ pyproject.toml (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω)
pip install -e ".[ml]"
```

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

```bash
python3 scripts/check_ledger_ml_deps.py
```

–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏:
```
‚úÖ –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –∏ —Ä–∞–±–æ—Ç–∞—é—Ç
‚úÖ Phase 1 –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é —Å –ø–æ–ª–Ω—ã–º semantic search
```

---

## üìã –ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã –¥–ª—è semantic search)

1. **hnswlib** (>=0.7.0)
   - HNSW-based –≤–µ–∫—Ç–æ—Ä–Ω—ã–π –∏–Ω–¥–µ–∫—Å
   - –†–∞–∑–º–µ—Ä: ~5-10 MB
   - –í—Ä–µ–º—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏: 1-2 –º–∏–Ω—É—Ç—ã

2. **sentence-transformers** (>=2.2.0)
   - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è embeddings
   - Re-ranking —á–µ—Ä–µ–∑ CrossEncoder
   - –†–∞–∑–º–µ—Ä: ~500 MB (—Å –º–æ–¥–µ–ª—è–º–∏)
   - –í—Ä–µ–º—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏: 5-10 –º–∏–Ω—É—Ç

### –£–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã (–≤ –ø—Ä–æ–µ–∫—Ç–µ)

- **numpy** ‚Äî –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –≤–µ–∫—Ç–æ—Ä–∞–º–∏
- **torch** ‚Äî –¥–ª—è ML –º–æ–¥–µ–ª–µ–π (–≤ pyproject.toml)

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
python3 scripts/check_ledger_ml_deps.py
```

### 2. –ë–∞–∑–æ–≤—ã–µ —Ç–µ—Å—Ç—ã

```bash
pytest tests/ledger/test_rag_search_basic.py -v
```

### 3. –ü–æ–ª–Ω—ã–µ —Ç–µ—Å—Ç—ã (—Ç—Ä–µ–±—É—é—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏)

```bash
pytest tests/ledger/test_rag_search.py -v
```

### 4. –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –ò–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ
python scripts/index_ledger_in_rag.py

# –ü–æ–∏—Å–∫
python scripts/ledger_rag_query.py "–ö–∞–∫–∏–µ –º–µ—Ç—Ä–∏–∫–∏?"

# –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –ø–æ–∏—Å–∫
python scripts/ledger_search_interactive.py
```

---

## üîç –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: hnswlib –Ω–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# Ubuntu/Debian
sudo apt-get install build-essential

# macOS
xcode-select --install

# –ó–∞—Ç–µ–º –ø–æ–≤—Ç–æ—Ä–∏—Ç–µ
pip install hnswlib
```

### –ü—Ä–æ–±–ª–µ–º–∞: sentence-transformers –º–µ–¥–ª–µ–Ω–Ω–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è

**–ü—Ä–∏—á–∏–Ω–∞:** –ó–∞–≥—Ä—É–∂–∞–µ—Ç –±–æ–ª—å—à–∏–µ –º–æ–¥–µ–ª–∏  
**–†–µ—à–µ–Ω–∏–µ:** –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ, –º–æ–¥–µ–ª–∏ –∫–µ—à–∏—Ä—É—é—Ç—Å—è

### –ü—Ä–æ–±–ª–µ–º–∞: –ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã –≤–µ—Ä—Å–∏–π

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
python3 -m venv venv
source venv/bin/activate
pip install -r requirements-ledger-ml.txt
```

---

## üìä –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –î–æ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

```
–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: 3/6
‚ö†Ô∏è  –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç
```

### –ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

```
–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: 6/6
‚úÖ –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –∏ —Ä–∞–±–æ—Ç–∞—é—Ç
‚úÖ Phase 1 –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é —Å –ø–æ–ª–Ω—ã–º semantic search
```

---

## üìù –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
   ```bash
   bash scripts/install_ledger_ml_deps.sh
   ```

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∫—É:**
   ```bash
   python3 scripts/check_ledger_ml_deps.py
   ```

3. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
   ```bash
   python scripts/index_ledger_in_rag.py
   python scripts/ledger_rag_query.py "–ö–∞–∫–∏–µ –º–µ—Ç—Ä–∏–∫–∏?"
   ```

4. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø–æ–ª–Ω—ã–µ —Ç–µ—Å—Ç—ã:**
   ```bash
   pytest tests/ledger/test_rag_search.py -v
   ```

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **–ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:** `docs/LEDGER_ML_DEPS_INSTALL.md`
- **Requirements —Ñ–∞–π–ª:** `requirements-ledger-ml.txt`
- **–°–∫—Ä–∏–ø—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏:** `scripts/install_ledger_ml_deps.sh`
- **–°–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏:** `scripts/check_ledger_ml_deps.py`

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ —É—Å—Ç–∞–Ω–æ–≤–∫–µ  
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2026-01-03

