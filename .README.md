# x0tta6bl4 Anti-Geolocation & Anonymity Hardening System

## Overview

Production-ready multi-layer defense system against geolocation detection and identity correlation across network, transport, application, and identity layers.

## Architecture

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                           x0tta6bl4 Anti-Geolocate                          │
│                         Defense-in-Depth Architecture                       │
└─────────────────────────────────────────────────────────────────────────────┘
                                     │
    ┌────────────────────────────────┼────────────────────────────────┐
    │                                │                                │
    ▼                                ▼                                ▼
┌──────────────┐            ┌──────────────┐            ┌──────────────┐
│   Layer 1    │            │   Layer 2    │            │   Layer 3    │
│   Network    │◄──────────►│  Transport   │◄──────────►│ Application  │
│   Egress     │            │    Layer     │            │    Layer     │
└──────────────┘            └──────────────┘            └──────────────┘
       │                            │                            │
       │    ┌───────────────────────┼───────────────────────┐    │
       │    │                       │                       │    │
       ▼    ▼                       ▼                       ▼    ▼
  ┌──────────────┐           ┌──────────────┐           ┌──────────────┐
  │  WARP/       │           │   DoH/DoT    │           │  Browser     │
  │  WireGuard   │           │   DNS Proxy  │           │  Hardening   │
  │  +KillSwitch │           │  + Traffic   │           │  +WebRTC blk │
  └──────────────┘           │    Shaping   │           └──────────────┘
                             └──────────────┘                  │
                                                                │
                                      ┌─────────────────────────┼─────────┐
                                      │                         │         │
                                      ▼                         ▼         ▼
                               ┌──────────────┐          ┌──────────────┐
                               │   Layer 5    │          │   Layer 6    │
                               │ Fingerprint  │          │   Identity   │
                               │Randomization │          │Compartmental.│
                               └──────────────┘          └──────────────┘
```

## Quick Start

### 1. Network Layer Hardening

```bash
# Enable killswitch (blocks all non-VPN traffic)
sudo ./network-layer/killswitch.sh enable

# Configure WARP+ WireGuard
sudo ./network-layer/warp-setup.sh

# Verify no IP leaks
curl -s https://ipleak.net/json/
```

### 2. Transport Layer DNS

```bash
# Deploy local DoH proxy
sudo ./transport-layer/dns-proxy.sh install

# Verify DNS-over-HTTPS
./transport-layer/dns-test.sh
```

### 3. Browser Hardening

```bash
# Apply Firefox hardening
./application-layer/firefox-hardening.sh

# Verify WebRTC disabled
# Visit: https://browserleaks.com/webrtc
```

## Layer-by-Layer Implementation

### Layer 1: Network Egress

| Component | File | Purpose |
|-----------|------|---------|
| Kill Switch | [`killswitch.sh`](network-layer/killswitch.sh) | Block non-VPN traffic |
| WARP Manager | [`warp-setup.sh`](network-layer/warp-setup.sh) | Cloudflare WARP setup |
| VPN Chain | [`vpn-chain-manager.py`](network-layer/vpn-chain-manager.py) | Multi-hop VPN |
| IP Verify | [`ip-verify.sh`](network-layer/ip-verify.sh) | Leak testing |

### Layer 2: Transport

| Component | File | Purpose |
|-----------|------|---------|
| DNS Proxy | [`dns-proxy.sh`](transport-layer/dns-proxy.sh) | DoH/DoT implementation |
| Traffic Shaper | [`traffic-shaper.sh`](transport-layer/traffic-shaper.sh) | Traffic analysis protection |
| MTU Optimizer | [`mtu-optimizer.sh`](transport-layer/mtu-optimizer.sh) | Prevent fragmentation leaks |

### Layer 3: Application

| Component | File | Purpose |
|-----------|------|---------|
| Firefox Config | [`firefox-hardening.js`](application-layer/firefox-hardening.js) | `about:config` policies |
| Chrome Config | [`chrome-hardening.sh`](application-layer/chrome-hardening.sh) | Chromium flags |
| Extension List | [`extensions.md`](application-layer/extensions.md) | Curated privacy extensions |

### Layer 4: Geolocation API

| Component | File | Purpose |
|-----------|------|---------|
| Location Block | [`location-block.sh`](geolocation-layer/location-block.sh) | Disable system geolocation |
| Permission Deny | [`permissions.json`](geolocation-layer/permissions.json) | Browser permission policies |
| RF Kill | [`rf-kill.sh`](geolocation-layer/rf-kill.sh) | Hardware radio disable |

### Layer 5: Fingerprint Randomization

| Component | File | Purpose |
|-----------|------|---------|
| RFP Config | [`resist-fingerprinting.md`](fingerprint-layer/resist-fingerprinting.md) | Firefox RFP settings |
| Canvas Block | [`canvas-randomization.js`](fingerprint-layer/canvas-randomization.js) | Canvas noise injection |
| Font Limit | [`font-restrictions.css`](fingerprint-layer/font-restrictions.css) | Reduce font entropy |

### Layer 6: Identity Management

| Component | File | Purpose |
|-----------|------|---------|
| Container Manager | [`container-manager.py`](identity-compartmentalization/container-manager.py) | Firefox containers |
| Profile Isolation | [`profile-isolation.sh`](identity-compartmentalization/profile-isolation.sh) | Separate profiles |
| Cookie Policy | [`cookie-policy.json`](identity-compartmentalization/cookie-policy.json) | Strict cookie handling |

## Monitoring & Verification

### Leak Detection

```bash
# Run comprehensive leak test
./monitoring/leak-detector.py --full-test

# Continuous monitoring
./monitoring/leak-detector.py --daemon
```

### Health Checks

```bash
# System hardening verification
./system-hardening/verify.sh

# All-layer test
./deployment/verify.sh
```

## Deployment

### Automated Installation

```bash
# Full system deployment
sudo ./deployment/install.sh --production

# Development mode (less restrictive)
sudo ./deployment/install.sh --development
```

### Manual Steps

See [`MANUAL_SETUP.md`](docs/MANUAL_SETUP.md) for step-by-step configuration.

## Operational Security

- [`operational-security.md`](ops-security/operational-security.md) - Usage patterns and OPSEC
- [`emergency-severance.sh`](ops-security/emergency-severance.sh) - Rapid identity severance protocol

## Testing Matrix

| Test | URL | Expected Result |
|------|-----|-----------------|
| IP Leak | ipleak.net | Single VPN IP |
| DNS Leak | dnsleaktest.com | No ISP DNS |
| WebRTC | browserleaks.com/webrtc | No host candidates |
| Canvas | browserleaks.com/canvas | Randomized |
| Fingerprint | coveryourtracks.eff.org | "Not unique" |
| IPv6 | test-ipv6.com | No connectivity |

## Requirements

- Linux kernel 5.4+ (iptables/nftables)
- Python 3.9+
- Firefox ESR 115+ or Chromium 120+
- OpenSSL 3.0+
- WireGuard tools

## License

MIT - See [`LICENSE`](LICENSE)

## Threat Model

This system addresses:
- IP-based geolocation (ASN/BGP correlation)
- DNS infrastructure fingerprinting (ECS leaks)
- WebRTC ICE candidate harvesting
- Geolocation API & sensor fusion
- Browser fingerprint entropy (100+ vectors)
- Account-based behavioral biometrics

See [`THREAT_MODEL.md`](docs/THREAT_MODEL.md) for complete analysis.
