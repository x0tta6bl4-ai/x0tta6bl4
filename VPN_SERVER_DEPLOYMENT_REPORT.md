# –û—Ç—á–µ—Ç –æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–∏ x0tta6bl4 –Ω–∞ VPN —Å–µ—Ä–≤–µ—Ä–µ

**–î–∞—Ç–∞:** 24 –Ω–æ—è–±—Ä—è 2025  
**–°–µ—Ä–≤–µ—Ä:** 89.125.1.107  
**–ü—Ä–æ–µ–∫—Ç:** x0tta6bl4 monitoring components –¥–ª—è VPN (Xray)

---

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Xray VPN —Å–µ—Ä–≤–µ—Ä–∞
- ‚úÖ Xray —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É 39829
- ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Reality —Å VLESS –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–º
- ‚úÖ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã –∫–ª—é—á–∏ –∏ UUID –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤
- ‚úÖ –°–µ—Ä–≤–∏—Å –∞–∫—Ç–∏–≤–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:**
- Server: 89.125.1.107
- Port: 39829
- UUID: f56fb669-32ec-4142-b2fe-8b65c4321102
- Public Key: xMwVfOuehQZwVHPodTvo3TJEGUYUbxmGTeAxMUBWpww
- SNI: google.com
- Flow: xtls-rprx-vision

### 2. –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ x0tta6bl4

#### 2.1 Prometheus Exporter
- ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω x0tta6bl4 Xray Prometheus Exporter
- ‚úÖ –°–µ—Ä–≤–∏—Å: `xray-exporter.service`
- ‚úÖ –ü–æ—Ä—Ç: 9090
- ‚úÖ Endpoints:
  - `/metrics` - Prometheus –º–µ—Ç—Ä–∏–∫–∏
  - `/health` - Health check endpoint

**–ú–µ—Ç—Ä–∏–∫–∏:**
- `xray_status` - —Å—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–∞ Xray (1=running, 0=stopped)
- `xray_uptime_seconds` - –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã —Å–µ—Ä–≤–∏—Å–∞
- `xray_connections_total` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π
- `xray_traffic_uplink_bytes_total` - –∏—Å—Ö–æ–¥—è—â–∏–π —Ç—Ä–∞—Ñ–∏–∫
- `xray_traffic_downlink_bytes_total` - –≤—Ö–æ–¥—è—â–∏–π —Ç—Ä–∞—Ñ–∏–∫

#### 2.2 Health Checks
- ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω —Å–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–¥–æ—Ä–æ–≤—å—è: `/opt/x0tta6bl4-monitor/xray_health_check.sh`
- ‚úÖ Systemd timer: `xray-health-check.timer` (–∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç:
  - –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–∞ Xray
  - –ü—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏–µ –ø–æ—Ä—Ç–∞ 39829
  - –í–∞–ª–∏–¥–Ω–æ—Å—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
  - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤ (CPU, Memory)

#### 2.3 Auto-Recovery
- ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω —Å–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è: `/opt/x0tta6bl4-monitor/xray_auto_recovery.sh`
- ‚úÖ Systemd timer: `xray-auto-recovery.timer` (–∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥)
- ‚úÖ –§—É–Ω–∫—Ü–∏–∏:
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏ —Å–µ—Ä–≤–∏—Å–∞
  - –ó–∞—â–∏—Ç–∞ –æ—Ç –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã—Ö –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–æ–≤ (cooldown 5 –º–∏–Ω—É—Ç)
  - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ `/var/log/x0tta6bl4-recovery.log`

---

## üìä –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å

### –°–µ—Ä–≤–∏—Å—ã
```
‚úÖ xray.service - Active (running)
‚úÖ xray-exporter.service - Active (running)
‚úÖ xray-health-check.timer - Active (waiting)
‚úÖ xray-auto-recovery.timer - Active (waiting)
```

### –ú–µ—Ç—Ä–∏–∫–∏ (–ø—Ä–∏–º–µ—Ä)
```
xray_status 1.0                    # Xray —Ä–∞–±–æ—Ç–∞–µ—Ç
xray_uptime_seconds 0.0            # –í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã (–æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫)
```

### Health Check
```json
{
    "status": "ok",
    "exporter": "x0tta6bl4-xray",
    "version": "1.0.0"
}
```

---

## üîß –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
```bash
# –°—Ç–∞—Ç—É—Å —ç–∫—Å–ø–æ—Ä—Ç–µ—Ä–∞
systemctl status xray-exporter

# –°—Ç–∞—Ç—É—Å —Ç–∞–π–º–µ—Ä–æ–≤
systemctl list-timers xray-*

# –†—É—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è
/opt/x0tta6bl4-monitor/xray_health_check.sh
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –º–µ—Ç—Ä–∏–∫
```bash
# Health endpoint
curl http://89.125.1.107:9090/health

# Prometheus metrics
curl http://89.125.1.107:9090/metrics
```

### –õ–æ–≥–∏
```bash
# –õ–æ–≥–∏ —ç–∫—Å–ø–æ—Ä—Ç–µ—Ä–∞
journalctl -u xray-exporter -f

# –õ–æ–≥–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
tail -f /var/log/x0tta6bl4-recovery.log

# –õ–æ–≥–∏ health checks
journalctl -u xray-health-check.service -f
```

---

## üöÄ –ü—Ä–∏–º–µ–Ω–µ–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã x0tta6bl4

### 1. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ Observability
- **Prometheus –º–µ—Ç—Ä–∏–∫–∏** - —ç–∫—Å–ø–æ—Ä—Ç –º–µ—Ç—Ä–∏–∫ –≤ —Ñ–æ—Ä–º–∞—Ç–µ Prometheus
- **Health checks** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- **–°–∏—Å—Ç–µ–º–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏** - –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ CPU, Memory, Network

### 2. Self-Healing (–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ)
- **Auto-recovery** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ —Å–±–æ—è—Ö
- **Cooldown –º–µ—Ö–∞–Ω–∏–∑–º** - –∑–∞—â–∏—Ç–∞ –æ—Ç –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã—Ö –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–æ–≤
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤** - –∑–∞–ø–∏—Å—å –≤—Å–µ—Ö —Å–æ–±—ã—Ç–∏–π –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è

### 3. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã
- **Modular design** - –º–æ–¥—É–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- **Systemd integration** - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å systemd –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏
- **Error handling** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ graceful degradation

---

## üìù –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### Security Scanning
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Bandit –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Trivy –¥–ª—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Xray

### –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Grafana –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
- [ ] –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–ª–µ—Ä—Ç–æ–≤ –≤ Prometheus Alertmanager
- [ ] –°–±–æ—Ä –º–µ—Ç—Ä–∏–∫ —Ç—Ä–∞—Ñ–∏–∫–∞ –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º

### MAPE-K —Ü–∏–∫–ª (–ø–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è)
- [ ] Monitor: –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π —Å–±–æ—Ä –º–µ—Ç—Ä–∏–∫
- [ ] Analyze: –ê–Ω–∞–ª–∏–∑ –∞–Ω–æ–º–∞–ª–∏–π —á–µ—Ä–µ–∑ GraphSAGE
- [ ] Plan: –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π –ø—Ä–∏ —Å–±–æ—è—Ö
- [ ] Execute: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–ª–∞–Ω–æ–≤
- [ ] Knowledge: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ–ø—ã—Ç–∞ –≤ –±–∞–∑—É –∑–Ω–∞–Ω–∏–π

---

## üì¶ –§–∞–π–ª—ã —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

–í—Å–µ —Ñ–∞–π–ª—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ `/opt/x0tta6bl4-monitor/`:
- `xray_exporter.py` - Prometheus exporter
- `xray_health_check.sh` - Health check —Å–∫—Ä–∏–ø—Ç
- `xray_auto_recovery.sh` - Auto-recovery —Å–∫—Ä–∏–ø—Ç

Systemd —Å–µ—Ä–≤–∏—Å—ã:
- `/etc/systemd/system/xray-exporter.service`
- `/etc/systemd/system/xray-health-check.service`
- `/etc/systemd/system/xray-health-check.timer`
- `/etc/systemd/system/xray-auto-recovery.service`
- `/etc/systemd/system/xray-auto-recovery.timer`

---

## ‚ú® –ò—Ç–æ–≥–∏

–£—Å–ø–µ—à–Ω–æ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—ã –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ —Å–∞–º–æ-–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è x0tta6bl4 –Ω–∞ VPN —Å–µ—Ä–≤–µ—Ä–µ. –°–∏—Å—Ç–µ–º–∞ —Ç–µ–ø–µ—Ä—å –∏–º–µ–µ—Ç:

1. ‚úÖ **–ü–æ–ª–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - –º–µ—Ç—Ä–∏–∫–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
2. ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏** - health checks –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
3. ‚úÖ **Self-healing** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ —Å–±–æ—è—Ö
4. ‚úÖ **Observability** - –ø–æ–ª–Ω–∞—è –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã

VPN —Å–µ—Ä–≤–µ—Ä —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç —Å enterprise-grade –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ–º, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–º –Ω–∞ –ø—Ä–∏–Ω—Ü–∏–ø–∞—Ö x0tta6bl4.

---

**–†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ:** ‚úÖ –£—Å–ø–µ—à–Ω–æ  
**–í—Ä–µ–º—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è:** ~15 –º–∏–Ω—É—Ç  
**–°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã:** üü¢ Operational

