apiVersion: networking.istio.io/v1beta1
kind: DestinationRule
metadata:
  name: x0tta6bl4-api
  namespace: x0tta6bl4
spec:
  host: x0tta6bl4-api.x0tta6bl4.svc.cluster.local
  trafficPolicy:
    tls:
      mode: ISTIO_MUTUAL
    connectionPool:
      tcp:
        maxConnections: 200
      http:
        http1MaxPendingRequests: 1000
        maxRequestsPerConnection: 100
    outlierDetection:
      consecutive5xxErrors: 5
      interval: 5s
      baseEjectionTime: 30s
      maxEjectionPercent: 50
  subsets:
    - name: stable
      labels:
        version: stable
    - name: canary
      labels:
        version: canary
---
apiVersion: networking.istio.io/v1beta1
kind: DestinationRule
metadata:
  name: x0tta6bl4-worker
  namespace: x0tta6bl4
spec:
  host: x0tta6bl4-worker.x0tta6bl4.svc.cluster.local
  trafficPolicy:
    tls:
      mode: ISTIO_MUTUAL
    outlierDetection:
      consecutive5xxErrors: 3
      interval: 3s
      baseEjectionTime: 15s
      maxEjectionPercent: 60
