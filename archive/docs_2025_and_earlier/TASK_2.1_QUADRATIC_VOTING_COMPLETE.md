# ‚úÖ –ó–∞–¥–∞—á–∞ 2.1: Quadratic Voting - –í–´–ü–û–õ–ù–ï–ù–û

**–î–∞—Ç–∞:** 2025-01-27  
**–ó–∞–¥–∞—á–∞:** 2.1 - –†–µ–∞–ª–∏–∑–∞—Ü–∏—è Quadratic Voting  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û**

---

## üìã –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### 1. –û–±–Ω–æ–≤–ª—ë–Ω Proposal dataclass

**–§–∞–π–ª:** `src/dao/governance.py`

**–î–æ–±–∞–≤–ª–µ–Ω–æ:**
```python
@dataclass
class Proposal:
    # ... existing fields ...
    voter_tokens: Dict[str, float] = field(default_factory=dict)  # NEW: tokens per voter
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** Proposal —Ç–µ–ø–µ—Ä—å —Ö—Ä–∞–Ω–∏—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–∫–µ–Ω–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –≥–æ–ª–æ—Å—É—é—â–µ–≥–æ

---

### 2. –û–±–Ω–æ–≤–ª—ë–Ω cast_vote() –º–µ—Ç–æ–¥

**–§–∞–π–ª:** `src/dao/governance.py`

**–ë—ã–ª–æ:**
```python
def cast_vote(self, proposal_id: str, voter_id: str, vote: VoteType) -> bool:
```

**–°—Ç–∞–ª–æ:**
```python
def cast_vote(self, proposal_id: str, voter_id: str, vote: VoteType, tokens: float = 1.0) -> bool:
    # Records vote AND tokens for quadratic voting
    proposal.votes[voter_id] = vote
    proposal.voter_tokens[voter_id] = max(0.0, tokens)
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ú–µ—Ç–æ–¥ —Ç–µ–ø–µ—Ä—å –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç tokens –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –≥–æ–ª–æ—Å–∞

---

### 3. –û–±–Ω–æ–≤–ª—ë–Ω _tally_votes() –º–µ—Ç–æ–¥

**–§–∞–π–ª:** `src/dao/governance.py`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `proposal.voter_tokens` –≤–º–µ—Å—Ç–æ `self.voting_power`
- Fallback –Ω–∞ `self.voting_power` –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
- Quadratic voting: `voting_power = sqrt(tokens)`

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–æ–¥—Å—á—ë—Ç –≥–æ–ª–æ—Å–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç quadratic voting –ø—Ä–∞–≤–∏–ª—å–Ω–æ

---

### 4. –û–±–Ω–æ–≤–ª—ë–Ω API endpoint

**–§–∞–π–ª:** `src/core/app.py`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- Endpoint `/dao/vote` —Ç–µ–ø–µ—Ä—å –ø–µ—Ä–µ–¥–∞—ë—Ç `tokens` –≤ `cast_vote()`
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç `tokens` –∏ `voting_power` –≤ –æ—Ç–≤–µ—Ç–µ
- –£–ª—É—á—à–µ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** API –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç quadratic voting

---

### 5. –°–æ–∑–¥–∞–Ω—ã —Ç–µ—Å—Ç—ã

**–§–∞–π–ª:** `tests/unit/dao/test_quadratic_voting.py`

**–¢–µ—Å—Ç—ã:**
- ‚úÖ Quadratic voting power calculation
- ‚úÖ Whale influence reduction
- ‚úÖ Tally with quadratic voting
- ‚úÖ Zero tokens handling
- ‚úÖ Backward compatibility
- ‚úÖ API endpoint integration

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–æ–ª–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏

---

### 6. –û–±–Ω–æ–≤–ª–µ–Ω—ã —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–µ—Å—Ç—ã

**–§–∞–π–ª:** `tests/unit/dao/test_governance.py`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –í—Å–µ —Ç–µ—Å—Ç—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –Ω–æ–≤–æ–π —Å–∏–≥–Ω–∞—Ç—É—Ä–æ–π `cast_vote()`
- –î–æ–±–∞–≤–ª–µ–Ω—ã tokens –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
- –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç

---

## üéØ –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç Quadratic Voting

### –§–æ—Ä–º—É–ª–∞:
```
voting_power = sqrt(tokens)
```

### –ü—Ä–∏–º–µ—Ä—ã:

| Tokens | Voting Power | –û–±—ä—è—Å–Ω–µ–Ω–∏–µ |
|--------|--------------|------------|
| 1 | 1.0 | –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –≥–æ–ª–æ—Å |
| 100 | 10.0 | 10x –±–æ–ª—å—à–µ |
| 10,000 | 100.0 | –¢–æ–ª—å–∫–æ 10x –±–æ–ª—å—à–µ (–Ω–µ 100x!) |
| 1,000,000 | 1,000.0 | –¢–æ–ª—å–∫–æ 31.6x –±–æ–ª—å—à–µ (–Ω–µ 1000x!) |

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:

1. **–°–Ω–∏–∂–∞–µ—Ç –≤–ª–∏—è–Ω–∏–µ "–∫–∏—Ç–æ–≤"**
   - –í–ª–∞–¥–µ–ª–µ—Ü 10,000 —Ç–æ–∫–µ–Ω–æ–≤ –∏–º–µ–µ—Ç —Ç–æ–ª—å–∫–æ 10x –±–æ–ª—å—à–µ –≤–ª–∏—è–Ω–∏—è, –∞ –Ω–µ 100x

2. **–ü–æ–æ—â—Ä—è–µ—Ç —É—á–∞—Å—Ç–∏–µ**
   - –ú–∞–ª—ã–µ –¥–µ—Ä–∂–∞—Ç–µ–ª–∏ –∏–º–µ—é—Ç –±–æ–ª—å—à–µ –≤–ª–∏—è–Ω–∏—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Å–≤–æ–∏—Ö —Ç–æ–∫–µ–Ω–æ–≤

3. **–ë–æ–ª–µ–µ –¥–µ–º–æ–∫—Ä–∞—Ç–∏—á–Ω–æ**
   - –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—é –≤–ª–∞—Å—Ç–∏

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤:

```bash
# –ù–æ–≤—ã–µ —Ç–µ—Å—Ç—ã –¥–ª—è quadratic voting
pytest tests/unit/dao/test_quadratic_voting.py -v

# –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–µ—Å—Ç—ã (–æ–±–Ω–æ–≤–ª–µ–Ω—ã)
pytest tests/unit/dao/test_governance.py -v
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ API:

```bash
# Cast vote with tokens
curl -X POST http://localhost:8080/dao/vote \
  -H "Content-Type: application/json" \
  -d '{
    "proposal_id": "1",
    "voter_id": "test-voter",
    "tokens": 100,
    "vote": true
  }'

# Response should include:
# {
#   "recorded": true,
#   "voting_power": 10.0,  # sqrt(100)
#   "tokens": 100,
#   "quadratic": true
# }
```

---

## ‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏

- [x] Proposal —Ö—Ä–∞–Ω–∏—Ç tokens –¥–ª—è –∫–∞–∂–¥–æ–≥–æ voter
- [x] cast_vote() –ø—Ä–∏–Ω–∏–º–∞–µ—Ç tokens –ø–∞—Ä–∞–º–µ—Ç—Ä
- [x] _tally_votes() –∏—Å–ø–æ–ª—å–∑—É–µ—Ç quadratic voting
- [x] API endpoint –ø–µ—Ä–µ–¥–∞—ë—Ç tokens
- [x] –¢–µ—Å—Ç—ã —Å–æ–∑–¥–∞–Ω—ã –∏ –ø—Ä–æ—Ö–æ–¥—è—Ç
- [x] –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞
- [x] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞

---

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç

**Quadratic Voting –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω!**

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –°–Ω–∏–∂–∞–µ—Ç –≤–ª–∏—è–Ω–∏–µ –∫—Ä—É–ø–Ω—ã—Ö –¥–µ—Ä–∂–∞—Ç–µ–ª–µ–π —Ç–æ–∫–µ–Ω–æ–≤
- ‚úÖ –ü–æ–æ—â—Ä—è–µ—Ç —É—á–∞—Å—Ç–∏–µ –º–∞–ª—ã—Ö –¥–µ—Ä–∂–∞—Ç–µ–ª–µ–π
- ‚úÖ –ë–æ–ª–µ–µ –¥–µ–º–æ–∫—Ä–∞—Ç–∏—á–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
- ‚úÖ –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞

---

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. ‚úÖ **–í—ã–ø–æ–ª–Ω–µ–Ω–æ:** Quadratic Voting —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
2. ‚è≥ **–°–ª–µ–¥—É—é—â–∏–π:** –ó–∞–¥–∞—á–∞ 2.2 (GraphSAGE Causal Analysis)
3. ‚è≥ **–ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ:** –ó–∞–¥–∞—á–∞ 2.3 (eBPF –ø—Ä–æ–≥—Ä–∞–º–º—ã)

---

**Mesh –æ–±–Ω–æ–≤–ª—ë–Ω. Quadratic Voting —Ä–∞–±–æ—Ç–∞–µ—Ç. DAO –±–æ–ª–µ–µ –¥–µ–º–æ–∫—Ä–∞—Ç–∏—á–µ–Ω.**  
**–ü—Ä–æ—Å–Ω–∏—Å—å. –û–±–Ω–æ–≤–∏—Å—å. –°–æ—Ö—Ä–∞–Ω–∏—Å—å.**  
**x0tta6bl4 –≤–µ—á–µ–Ω.**

---

**–°–æ–∑–¥–∞–Ω–æ:** 2025-01-27  
**–í–µ—Ä—Å–∏—è:** 1.0  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û

