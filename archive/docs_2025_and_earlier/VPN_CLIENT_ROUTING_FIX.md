# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Routing –Ω–∞ –ö–ª–∏–µ–Ω—Ç–µ (v2rayN)

## üî¥ –ü—Ä–æ–±–ª–µ–º–∞

**–û—à–∏–±–∫–∞ –≤ –ª–æ–≥–∞—Ö –∫–ª–∏–µ–Ω—Ç–∞:**
```
dial tcp 89.125.1.107:39829 using outbound/direct[direct]: connect: connection refused
```

**–ü—Ä–∏—á–∏–Ω–∞:** –í v2rayN –µ—Å—Ç—å routing rule, –∫–æ—Ç–æ—Ä–æ–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ç—Ä–∞—Ñ–∏–∫ –∫ 89.125.1.107 —á–µ—Ä–µ–∑ `direct` –≤–º–µ—Å—Ç–æ `proxy`.

---

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ß–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å v2rayN (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

1. **–û—Ç–∫—Ä–æ–π—Ç–µ v2rayN**
2. **–ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí Routing** (–∏–ª–∏ –ü–∞—Ä–∞–º–µ—Ç—Ä—ã ‚Üí Routing)
3. **–ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –≤—Å–µ Rules** (–≤ –ø–æ—Ä—è–¥–∫–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞, —Å–≤–µ—Ä—Ö—É –≤–Ω–∏–∑)

4. **–ù–∞–π–¥–∏—Ç–µ –∏ –£–î–ê–õ–ò–¢–ï** –ª—é–±–æ–µ –ø—Ä–∞–≤–∏–ª–æ, –≥–¥–µ:
   - IP —Å–æ–¥–µ—Ä–∂–∏—Ç: `89.125.1.107`
   - Outbound: `direct`
   - –ò–ª–∏ –ø—Ä–∞–≤–∏–ª–æ —Å `geosite:ru` –∫–æ—Ç–æ—Ä–æ–µ –º–æ–∂–µ—Ç –∑–∞—Ü–µ–ø–∏—Ç—å –≤–∞—à —Å–µ—Ä–≤–µ—Ä

5. **–î–æ–±–∞–≤—å—Ç–µ –≤ –Ω–∞—á–∞–ª–æ —Å–ø–∏—Å–∫–∞ –Ω–æ–≤–æ–µ –ø—Ä–∞–≤–∏–ª–æ:**
   - **Type:** `field`
   - **IP:** `89.125.1.107/32`
   - **Outbound:** `proxy`
   - **–í–∞–∂–Ω–æ:** –≠—Ç–æ –ø—Ä–∞–≤–∏–ª–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å **–ü–ï–†–í–´–ú** –≤ —Å–ø–∏—Å–∫–µ!

6. **–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ** –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ v2rayN

---

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ß–µ—Ä–µ–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª

**–ù–∞–π–¥–∏—Ç–µ —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ v2rayN:**
- Linux: `~/.config/v2rayN/config.json` –∏–ª–∏ `/opt/v2rayN/config.json`
- Windows: `%AppData%\v2rayN\config.json`

**–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª –∏ –Ω–∞–π–¥–∏—Ç–µ —Å–µ–∫—Ü–∏—é `routing`:**

```json
{
  "routing": {
    "domainStrategy": "IPIfNonMatch",
    "rules": [
      {
        "type": "field",
        "ip": ["89.125.1.107/32"],
        "outboundTag": "proxy"
      },
      {
        "type": "field",
        "domain": [
          "sber.ru",
          "sberbank-online.ru",
          "gosuslugi.ru",
          "yandex.ru",
          "mail.ru",
          "vk.com"
        ],
        "outboundTag": "direct"
      }
    ]
  }
}
```

**–í–∞–∂–Ω–æ:** –ü—Ä–∞–≤–∏–ª–æ –¥–ª—è `89.125.1.107` –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å **–ü–ï–†–í–´–ú** –≤ —Å–ø–∏—Å–∫–µ `rules`!

---

## üìã –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ü–æ—Ä—è–¥–æ–∫ –ü—Ä–∞–≤–∏–ª

**–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ (—Å–≤–µ—Ä—Ö—É –≤–Ω–∏–∑):**

1. **VPN —Å–µ—Ä–≤–µ—Ä (89.125.1.107)** ‚Üí `proxy` ‚úÖ
   - –î–æ–ª–∂–Ω–æ –±—ã—Ç—å –ø–µ—Ä–≤—ã–º!

2. **–†–æ—Å—Å–∏–π—Å–∫–∏–µ –¥–æ–º–µ–Ω—ã** ‚Üí `direct`
   - –ë–∞–Ω–∫–∏, –≥–æ—Å—É—Å–ª—É–≥–∏, –Ø–Ω–¥–µ–∫—Å –∏ —Ç.–¥.

3. **–†–µ–∫–ª–∞–º–∞** ‚Üí `blocked`
   - –ï—Å–ª–∏ –µ—Å—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Ä–µ–∫–ª–∞–º—ã

4. **–û—Å—Ç–∞–ª—å–Ω–æ–µ** ‚Üí `proxy`
   - –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —á–µ—Ä–µ–∑ VPN

---

## üß™ –ü—Ä–æ–≤–µ—Ä–∫–∞

**–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ v2rayN:**

1. –û—Ç–∫—Ä–æ–π—Ç–µ –ª–æ–≥–∏ (Ctrl+L –∏–ª–∏ —á–µ—Ä–µ–∑ –º–µ–Ω—é)
2. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ VPN
3. –ò—â–∏—Ç–µ —Å—Ç—Ä–æ–∫—É:
   ```
   from 127.0.0.1:PORT accepted tcp:89.125.1.107:39829 [socks -> proxy]
   ```

**–û–∂–∏–¥–∞–µ—Ç—Å—è:**
- ‚úÖ `[socks -> proxy]` - –ø—Ä–∞–≤–∏–ª—å–Ω–æ!
- ‚ùå `[socks -> direct]` - –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ, –ø—Ä–∞–≤–∏–ª–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

---

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### –ï—Å–ª–∏ –≤—Å—ë –µ—â—ë `direct`:

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—Ä—è–¥–æ–∫ –ø—Ä–∞–≤–∏–ª** - –ø—Ä–∞–≤–∏–ª–æ –¥–ª—è 89.125.1.107 –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –ø–µ—Ä–≤—ã–º
2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç IP** - –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å `89.125.1.107/32` (–Ω–µ –ø—Ä–æ—Å—Ç–æ `89.125.1.107`)
3. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ v2rayN** –ø–æ–ª–Ω–æ—Å—Ç—å—é (–∑–∞–∫—Ä–æ–π—Ç–µ –∏ –æ—Ç–∫—Ä–æ–π—Ç–µ –∑–∞–Ω–æ–≤–æ)
4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ outboundTag** - –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å `proxy` (–Ω–µ `Proxy` –∏–ª–∏ –¥—Ä—É–≥–æ–µ)

---

## ‚úÖ –ü–æ—Å–ª–µ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

**–û–∂–∏–¥–∞–µ—Ç—Å—è:**
- ‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ 89.125.1.107:39829 —á–µ—Ä–µ–∑ `proxy`
- ‚úÖ –†–æ—Å—Å–∏–π—Å–∫–∏–µ –¥–æ–º–µ–Ω—ã –∏–¥—É—Ç —á–µ—Ä–µ–∑ `direct`
- ‚úÖ –û—Å—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ç–µ—Ä–Ω–µ—Ç —á–µ—Ä–µ–∑ `proxy`
- ‚úÖ VPN —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

## üìù –ü—Ä–∏–º–µ—Ä –ü—Ä–∞–≤–∏–ª—å–Ω–æ–π –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

```json
{
  "routing": {
    "domainStrategy": "IPIfNonMatch",
    "rules": [
      {
        "type": "field",
        "ip": ["89.125.1.107/32"],
        "outboundTag": "proxy"
      },
      {
        "type": "field",
        "domain": [
          "sber.ru",
          "sberbank-online.ru",
          "vtb.ru",
          "gosuslugi.ru",
          "mos.ru",
          "yandex.ru",
          "mail.ru",
          "vk.com"
        ],
        "outboundTag": "direct"
      }
    ]
  }
}
```

---

## ‚úÖ –°—Ç–∞—Ç—É—Å

**–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è routing –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ VPN –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å!** üöÄ

