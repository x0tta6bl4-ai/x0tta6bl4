# üìê TechnicalDrawing.ts - –ü–æ–¥—Ä–æ–±–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –í–´–°–û–ö–ò–ô  
**–í—Ä–µ–º—è:** ~3 —á–∞—Å–∞  
**–†–∏—Å–∫:** ‚úÖ –ù–∏–∑–∫–∏–π  
**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚≠ê‚≠ê‚≠ê –°—Ä–µ–¥–Ω—è—è

---

## üìã –û–±–∑–æ—Ä

### –ß—Ç–æ —ç—Ç–æ?
–°–µ—Ä–≤–∏—Å –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ **4-–≤–∏–¥–æ–≤—ã—Ö —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö —á–µ—Ä—Ç–µ–∂–µ–π** (–≤–∏–¥ —Å–ø–µ—Ä–µ–¥–∏, —Å–≤–µ—Ä—Ö—É, —Å–ª–µ–≤–∞, 3D –∏–∑–æ–º–µ—Ç—Ä–∏—è) —Å —Ä–∞–∑–º–µ—Ä–∞–º–∏ –∏ –∞–Ω–Ω–æ—Ç–∞—Ü–∏—è–º–∏.

### –ì–¥–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ V2?
```
–±–∞–∑–∏—Å-–≤–µ–±-v2/
‚îî‚îÄ‚îÄ services/
    ‚îî‚îÄ‚îÄ TechnicalDrawing.ts         (~150 —Å—Ç—Ä–æ–∫)
```

### –ì–¥–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –≤ V1?
```
–±–∞–∑–∏—Å-–≤–µ–±/
‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îî‚îÄ‚îÄ TechnicalDrawing.ts         ‚Üê –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—é–¥–∞
‚îî‚îÄ‚îÄ components/
    ‚îî‚îÄ‚îÄ DrawingView/
        ‚îî‚îÄ‚îÄ TechnicalDrawing.tsx     ‚Üê –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ —ç—Ç–æ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ
```

---

## üîç –ß—Ç–æ –¥–µ–ª–∞–µ—Ç –∫–æ–¥ V2?

```typescript
class TechnicalDrawing {
  // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç 4 —á–µ—Ä—Ç–µ–∂–∞
  generateDrawings(assembly: Assembly): DrawingSet
  
  // –î–æ–±–∞–≤–ª—è–µ—Ç —Ä–∞–∑–º–µ—Ä—ã
  addDimensions(drawing: Drawing, panels: Panel[]): void
  
  // –í—ã–≤–æ–¥–∏—Ç –≤ SVG/PDF
  export(drawings: DrawingSet, format: 'svg' | 'pdf'): Blob
}
```

**–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**
- `assembly` (Assembly object –∏–∑ V1) ‚úÖ
- `panels` (Panel[] –∏–∑ V1 store) ‚úÖ

**–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**
- SVG —á–µ—Ä—Ç–µ–∂–∏ (–º–æ–∂–Ω–æ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ PDF)
- –†–∞–∑–º–µ—Ä—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–ª–æ–∏ (Body, Facade, Back)

---

## üîó –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

### V2 –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–ª—è TechnicalDrawing:
```json
{
  "pdfkit": "^0.17.2",        // ‚ö†Ô∏è –ï–°–¢–¨ –í V1 ‚úÖ
  "recharts": "^3.6.0"        // ‚ö†Ô∏è –ï–°–¢–¨ –í V1 ‚úÖ
}
```

‚úÖ **–•–æ—Ä–æ—à–∏–µ –Ω–æ–≤–æ—Å—Ç–∏:** –í—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É–∂–µ –µ—Å—Ç—å –≤ V1!

---

## üìê –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–∞–∑–ª–∏—á–∏—è

### V2 –ø–æ–¥—Ö–æ–¥ (–ø—Ä–æ—Å—Ç–æ–π):
```
Assembly ‚Üí TechnicalDrawing ‚Üí SVG —á–µ—Ä—Ç–µ–∂–∏
```

### V1 –ø–æ–¥—Ö–æ–¥ (—Ç–µ–∫—É—â–∏–π):
```
Assembly ‚Üí DrawingView ‚Üí Recharts ‚Üí Canvas
```

### –ö–∞–∫ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å:
```
DrawingView + TechnicalDrawing —Å–µ—Ä–≤–∏—Å = –ª—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
```

---

## üîÄ –ü–ª–∞–Ω –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

### –≠—Ç–∞–ø 1: –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ (15 –º–∏–Ω)
```bash
# 1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª
cp "archived/v2-mvp-reference/source/services/TechnicalDrawing.ts" \
   "services/TechnicalDrawing.ts"

# 2. –û–±–Ω–æ–≤–∏—Ç–µ –∏–º–ø–æ—Ä—Ç—ã (–∑–∞–º–µ–Ω–∏—Ç–µ –ø—É—Ç–∏)
# –ë—ã–ª–æ:  import { Panel } from '../types'
# –°—Ç–∞–ª–æ: import { Panel } from '../types'
# (–æ–±—ã—á–Ω–æ –Ω–µ –Ω—É–∂–Ω–æ –º–µ–Ω—è—Ç—å, –µ—Å–ª–∏ –ø—É—Ç–∏ —Å–æ–≤–ø–∞–¥–∞—é—Ç)
```

### –≠—Ç–∞–ø 2: –ê–¥–∞–ø—Ç–∞—Ü–∏—è —Ç–∏–ø–æ–≤ (30 –º–∏–Ω)

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Ç–∏–ø–æ–≤:**

‚ùì V2 –∏—Å–ø–æ–ª—å–∑—É–µ—Ç:
```typescript
export interface Assembly {
  id: string;
  components: Component[];
  constraints?: Constraint[];
  metadata: AssemblyMetadata;
}
```

‚úÖ V1 –∏–º–µ–µ—Ç:
```typescript
// –í types/CADTypes.ts
export interface Assembly {
  id: string;
  components: Component[];
  constraints?: Constraint[];
  metadata: {
    version: string;
    createdAt: Date;
    modifiedAt: Date;
  };
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ –¢–∏–ø—ã —Å–æ–≤–º–µ—Å—Ç–∏–º—ã!

### –≠—Ç–∞–ø 3: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç (60 –º–∏–Ω)

**–û–±–Ω–æ–≤–∏—Ç–µ DrawingView.tsx:**

```typescript
// –ë—ã–ª–æ:
import { BOM } from '../services/BillOfMaterials';

// –î–æ–±–∞–≤—å—Ç–µ:
import { TechnicalDrawing } from '../services/TechnicalDrawing';

// –í –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ:
const DrawingView = () => {
  const panels = useProjectStore(s => s.panels);
  const assembly = useProjectStore(s => s.solvedAssembly);
  
  // –î–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤—ã–π —Å–µ—Ä–≤–∏—Å
  const drawer = new TechnicalDrawing();
  const drawings = drawer.generateDrawings(assembly || createAssemblyFromPanels(panels));
  
  return (
    <div>
      {/* –¢–µ–∫—É—â–∏–µ —á–µ—Ä—Ç–µ–∂–∏ */}
      {/* + –ù–æ–≤—ã–µ 4-–≤–∏–¥–æ–≤—ã–µ —á–µ—Ä—Ç–µ–∂–∏ */}
      <TechnicalDrawingViewer drawings={drawings} />
    </div>
  );
};
```

### –≠—Ç–∞–ø 4: –≠–∫—Å–ø–æ—Ä—Ç (30 –º–∏–Ω)

**–î–æ–±–∞–≤—å—Ç–µ –∫–Ω–æ–ø–∫—É —ç–∫—Å–ø–æ—Ä—Ç–∞:**

```typescript
const exportDrawings = () => {
  const drawer = new TechnicalDrawing();
  const drawings = drawer.generateDrawings(assembly);
  const pdf = drawer.export(drawings, 'pdf');
  
  // –°–∫–∞—á–∞—Ç—å
  const url = URL.createObjectURL(pdf);
  const a = document.createElement('a');
  a.href = url;
  a.download = `${projectName}_—á–µ—Ä—Ç–µ–∂–∏.pdf`;
  a.click();
};
```

### –≠—Ç–∞–ø 5: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (45 –º–∏–Ω)

```typescript
// –ù–∞–ø–∏—à–∏—Ç–µ –ø—Ä–æ—Å—Ç–æ–π —Ç–µ—Å—Ç
test('TechnicalDrawing –¥–æ–ª–∂–µ–Ω –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å 4 —á–µ—Ä—Ç–µ–∂–∞', () => {
  const drawer = new TechnicalDrawing();
  const drawings = drawer.generateDrawings(mockAssembly);
  
  expect(drawings.front).toBeDefined();      // –í–∏–¥ —Å–ø–µ—Ä–µ–¥–∏
  expect(drawings.top).toBeDefined();        // –í–∏–¥ —Å–≤–µ—Ä—Ö—É
  expect(drawings.left).toBeDefined();       // –í–∏–¥ —Å–ª–µ–≤–∞
  expect(drawings.isometric).toBeDefined();  // 3D –∏–∑–æ–º–µ—Ç—Ä–∏—è
});
```

---

## üéØ –ß–µ–∫-–ª–∏—Å—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

- [ ] **–ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ**
  - [ ] –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω —Ñ–∞–π–ª `TechnicalDrawing.ts`
  - [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω—ã –∏–º–ø–æ—Ä—Ç—ã
  - [ ] –ù–µ—Ç –æ—à–∏–±–æ–∫ TypeScript

- [ ] **–ê–¥–∞–ø—Ç–∞—Ü–∏—è**
  - [ ] –¢–∏–ø—ã —Å–æ–≤–º–µ—Å—Ç–∏–º—ã (Assembly, Panel, Component)
  - [ ] –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–æ—Å—Ç—É–ø–Ω—ã (pdfkit, recharts)
  - [ ] –ú–µ—Ç–æ–¥—ã —Å–∏–≥–Ω–∞—Ç—É—Ä —Å–æ–≤–ø–∞–¥–∞—é—Ç

- [ ] **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**
  - [ ] –î–æ–±–∞–≤–ª–µ–Ω –≤ `services/` –ø–∞–ø–∫—É
  - [ ] –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω –≤ DrawingView.tsx
  - [ ] –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —á–µ—Ä—Ç–µ–∂–∏ –±–µ–∑ –æ—à–∏–±–æ–∫
  - [ ] –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω —Å Zustand store

- [ ] **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª**
  - [ ] –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –≤–∏–¥ —Å–ø–µ—Ä–µ–¥–∏ ‚úÖ
  - [ ] –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –≤–∏–¥ —Å–≤–µ—Ä—Ö—É ‚úÖ
  - [ ] –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –≤–∏–¥ —Å–ª–µ–≤–∞ ‚úÖ
  - [ ] –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç 3D –∏–∑–æ–º–µ—Ç—Ä–∏—é ‚úÖ
  - [ ] –†–∞–∑–º–µ—Ä—ã –ø—Ä–æ—Å—Ç–∞–≤–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ ‚úÖ

- [ ] **–≠–∫—Å–ø–æ—Ä—Ç**
  - [ ] –≠–∫—Å–ø–æ—Ä—Ç –≤ SVG —Ä–∞–±–æ—Ç–∞–µ—Ç
  - [ ] –≠–∫—Å–ø–æ—Ä—Ç –≤ PDF —Ä–∞–±–æ—Ç–∞–µ—Ç
  - [ ] –ò–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ
  - [ ] –†–∞–∑–º–µ—Ä—ã –ª–∏—Å—Ç–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã

- [ ] **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**
  - [ ] Unit —Ç–µ—Å—Ç—ã –Ω–∞–ø–∏—Å–∞–Ω—ã
  - [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã
  - [ ] –°—Ç–∞—Ä—ã–µ —á–µ—Ä—Ç–µ–∂–∏ –≤—Å—ë –µ—â—ë —Ä–∞–±–æ—Ç–∞—é—Ç
  - [ ] –ù–µ—Ç —Ä–µ–≥—Ä–µ—Å—Å–∏–∏

- [ ] **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**
  - [ ] –î–æ–±–∞–≤–ª–µ–Ω—ã –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤ –∫–æ–¥–µ
  - [ ] –û–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
  - [ ] –î–æ–±–∞–≤–ª–µ–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –≤ README

---

## ‚ö†Ô∏è –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### –ü—Ä–æ–±–ª–µ–º–∞ 1: "TechnicalDrawing –Ω–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω"
**–†–µ—à–µ–Ω–∏–µ:**
```typescript
// –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –≤ —Ñ–∞–π–ª–µ –µ—Å—Ç—å export
export class TechnicalDrawing {
  // ...
}
```

### –ü—Ä–æ–±–ª–µ–º–∞ 2: "Assembly —Ç–∏–ø—ã –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç"
**–†–µ—à–µ–Ω–∏–µ:**
–ê–¥–∞–ø—Ç–∏—Ä—É–π—Ç–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã:
```typescript
// –ï—Å–ª–∏ types –æ—Ç–ª–∏—á–∞—é—Ç—Å—è, —Å–æ–∑–¥–∞–π—Ç–µ –∞–¥–∞–ø—Ç–µ—Ä
const adaptAssembly = (v1Assembly: V1Assembly): V2Assembly => {
  return {
    id: v1Assembly.id,
    components: v1Assembly.components,
    constraints: v1Assembly.constraints,
    metadata: {
      version: '1.0.0',
      createdAt: new Date(),
      modifiedAt: new Date(),
      ...v1Assembly.metadata
    }
  };
};
```

### –ü—Ä–æ–±–ª–µ–º–∞ 3: "PDF –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —Å–ª–∏—à–∫–æ–º –¥–æ–ª–≥–æ"
**–†–µ—à–µ–Ω–∏–µ:**
–ö–µ—à–∏—Ä—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:
```typescript
private drawingCache = new Map<string, DrawingSet>();

generateDrawings(assembly: Assembly) {
  const cacheKey = assembly.id;
  if (this.drawingCache.has(cacheKey)) {
    return this.drawingCache.get(cacheKey)!;
  }
  const drawings = this._generate(assembly);
  this.drawingCache.set(cacheKey, drawings);
  return drawings;
}
```

---

## üìä –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –î–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:
```
DrawingView –∫–æ–º–ø–æ–Ω–µ–Ω—Ç:
- –ë–∞–∑–æ–≤—ã–µ 2D —á–µ—Ä—Ç–µ–∂–∏ (–ª–∏–Ω–∏–∏/–ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–∏)
- –ë–µ–∑ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö —Ä–∞–∑–º–µ—Ä–Ω—ã—Ö –ª–∏–Ω–∏–π
- –°–ª–æ–∂–Ω–æ —á–∏—Ç–∞—Ç—å –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞
```

### –ü–æ—Å–ª–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:
```
DrawingView –∫–æ–º–ø–æ–Ω–µ–Ω—Ç:
- 4 –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –≤–∏–¥–∞ (—Å–ø–µ—Ä–µ–¥–∏, —Å–≤–µ—Ä—Ö—É, —Å–ª–µ–≤–∞, 3D)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ä–∞–∑–º–µ—Ä—ã –∏ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏
- –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ì–û–°–¢ (–ª–µ–≥–∫–æ —á–∏—Ç–∞—Ç—å)
- –≠–∫—Å–ø–æ—Ä—Ç –≤ PDF –≥–æ—Ç–æ–≤ –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞
```

---

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. ‚úÖ –°–∫–æ–ø–∏—Ä—É–π—Ç–µ `TechnicalDrawing.ts`
2. ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–∏–ø—ã —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
3. ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∏—Ä—É–π—Ç–µ –≤ DrawingView.tsx
4. ‚úÖ –î–æ–±–∞–≤—å—Ç–µ —ç–∫—Å–ø–æ—Ä—Ç PDF
5. ‚úÖ –ù–∞–ø–∏—à–∏—Ç–µ —Ç–µ—Å—Ç—ã
6. ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏

---

**–í—Ä–µ–º—è –¥–æ –ø–æ–ª–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:** ~3 —á–∞—Å–∞ ‚è±Ô∏è

**–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ** ‚Üí –ü–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –Ω–∞ **SheetNesting.ts** (—Å–ª–µ–¥—É—é—â–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
