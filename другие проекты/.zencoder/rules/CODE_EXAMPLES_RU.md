# –ü—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞ –∏ –¥–∏–∞–≥—Ä–∞–º–º—ã BazisLite-Web

## 1. –î–∏–∞–≥—Ä–∞–º–º–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                        UI Components                             ‚îÇ
‚îÇ (Scene3D, EditorPanel, CutList, NestingView, ProductionPipeline)‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                      ProjectStore (Zustand)                      ‚îÇ
‚îÇ  panels[], selectedPanel, history, CAD data, productionStage    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚Üì         ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  InputValidator                 ‚îÇ  ‚îÇ  CabinetGenerator        ‚îÇ
‚îÇ ‚Ä¢ Validate dimensions           ‚îÇ  ‚îÇ ‚Ä¢ generate(): Panel[]    ‚îÇ
‚îÇ ‚Ä¢ Check constraints             ‚îÇ  ‚îÇ ‚Ä¢ generateWithConstraints‚îÇ
‚îÇ ‚Ä¢ Type conversion               ‚îÇ  ‚îÇ ‚Ä¢ calculateShelfStiffness‚îÇ
‚îÇ ‚Ä¢ Error reporting               ‚îÇ  ‚îÇ ‚Ä¢ generateHardware()     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                      ‚îÇ
                                      ‚Üì
                         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                         ‚îÇ  ConstraintSolver          ‚îÇ
                         ‚îÇ ‚Ä¢ solve() - Newton-Raphson‚îÇ
                         ‚îÇ ‚Ä¢ computeJacobian()        ‚îÇ
                         ‚îÇ ‚Ä¢ solveLU()                ‚îÇ
                         ‚îÇ ‚Ä¢ validateConstraints()    ‚îÇ
                         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                      ‚îÇ
                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    ‚Üì                 ‚Üì                 ‚Üì
        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
        ‚îÇ BillOfMaterials  ‚îÇ  ‚îÇ  DFMValidator    ‚îÇ  ‚îÇ FEAIntegration   ‚îÇ
        ‚îÇ ‚Ä¢ calcMass()     ‚îÇ  ‚îÇ ‚Ä¢ validate()     ‚îÇ  ‚îÇ ‚Ä¢ analyze()      ‚îÇ
        ‚îÇ ‚Ä¢ calcCost()     ‚îÇ  ‚îÇ ‚Ä¢ checkRules()   ‚îÇ  ‚îÇ ‚Ä¢ stress()       ‚îÇ
        ‚îÇ ‚Ä¢ calcTime()     ‚îÇ  ‚îÇ ‚Ä¢ generateReport ‚îÇ  ‚îÇ ‚Ä¢ deflection()   ‚îÇ
        ‚îÇ ‚Ä¢ exportBOM()    ‚îÇ  ‚îÇ                  ‚îÇ  ‚îÇ                  ‚îÇ
        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                    ‚îÇ
                    ‚Üì
        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
        ‚îÇ   geminiService              ‚îÇ
        ‚îÇ ‚Ä¢ generateDesign()           ‚îÇ
        ‚îÇ ‚Ä¢ auditConstruction()        ‚îÇ
        ‚îÇ ‚Ä¢ askExpert()                ‚îÇ
        ‚îÇ ‚Ä¢ optimizeDesign()           ‚îÇ
        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                    ‚îÇ
                    ‚Üì
        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
        ‚îÇ   hardwareUtils              ‚îÇ
        ‚îÇ ‚Ä¢ validatePosition()         ‚îÇ
        ‚îÇ ‚Ä¢ calculateOptimalPositions()‚îÇ
        ‚îÇ ‚Ä¢ generateHardwareArray()    ‚îÇ
        ‚îÇ ‚Ä¢ checkInterferences()       ‚îÇ
        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## 2. CabinetGenerator –ø—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞

### 2.1 –ë–∞–∑–æ–≤–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è

```typescript
import { CabinetGenerator, STD } from './services/CabinetGenerator';
import { MATERIAL_LIBRARY } from './materials.config';

const config: CabinetConfig = {
  name: '–®–∫–∞—Ñ-–∫—É–ø–µ',
  type: 'straight',
  width: 2400,      // –º–º
  height: 2200,     // –º–º
  depth: 650,       // –º–º
  doorType: 'sliding',
  doorCount: 2,
  baseType: 'legs',
  facadeStyle: 'combined'
};

const sections: Section[] = [
  { id: 1, width: 1200, items: [
    { id: '1-1', type: 'shelf', y: 800, height: 50, name: '–ü–æ–ª–∫–∞' }
  ]},
  { id: 2, width: 1200, items: [
    { id: '2-1', type: 'rod', y: 1900, height: 0, name: '–®—Ç–∞–Ω–≥–∞' }
  ]}
];

const generator = new CabinetGenerator(config, sections, MATERIAL_LIBRARY);
const panels = generator.generate();

// –†–µ–∑—É–ª—å—Ç–∞—Ç:
// panels[0]: –±–æ–∫–æ–≤–∞—è —Å—Ç–µ–Ω–∫–∞ –ª–µ–≤–∞—è (1200x2200x16)
// panels[1]: –±–æ–∫–æ–≤–∞—è —Å—Ç–µ–Ω–∫–∞ –ø—Ä–∞–≤–∞—è (1200x2200x16)
// panels[2]: –∫—Ä—ã—à–∞ (2400x650x16)
// panels[3]: –¥–Ω–æ (2400x650x16)
// panels[4]: –ø–æ–ª–∫–∞ (1200x650x16)
// panels[5]: —Ñ–∞—Å–∞–¥ –¥–≤–µ—Ä–∏ –ª–µ–≤–æ–π (1200x2200x4)
// ...
```

### 2.2 –†–∞—Å—á–µ—Ç –ø—Ä–æ–≥–∏–±–∞ –ø–æ–ª–∫–∏

```typescript
// –ü–æ–ª–∫–∞ 1200–º–º —à–∏—Ä–∏–Ω–∞, 650–º–º –≥–ª—É–±–∏–Ω–∞, 16–º–º —Ç–æ–ª—â–∏–Ω–∞, —Å—Ä–µ–¥–Ω—è—è –Ω–∞–≥—Ä—É–∑–∫–∞
const stiffness = generator.calculateShelfStiffness(
  width: 1200,
  depth: 650,
  thickness: 16,
  loadClass: 'medium'  // 40–∫–≥ –Ω–∞–≥—Ä—É–∑–∫–∏
);

// –†–µ–∑—É–ª—å—Ç–∞—Ç:
{
  deflection: 2.3,              // –º–º (–ø—Ä–æ–≥–∏–±)
  maxAllowed: 3.0,              // –º–º (–Ω–æ—Ä–º–∞)
  needsStiffener: false,        // –£—Å–∏–ª–∏—Ç–µ–ª—å –Ω–µ –Ω—É–∂–µ–Ω
  recommendedRibHeight: 0,      // –º–º
  supportSpacing: 32            // –º–º –º–µ–∂–¥—É –æ–ø–æ—Ä–∞–º–∏
}

// –ï—Å–ª–∏ deflection > maxAllowed:
if (stiffness.needsStiffener) {
  // –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–¥–æ–ª—å–Ω–æ–µ —É—Å–∏–ª–µ–Ω–∏–µ (rib) –Ω–∞ –Ω–∏–∂–Ω—é—é –≥—Ä–∞–Ω—å –ø–æ–ª–∫–∏
  const rib: Panel = {
    id: 'rib-1',
    name: '–£—Å–∏–ª–∏—Ç–µ–ª—å –ø–æ–ª–∫–∏',
    width: 1200,
    height: stiffness.recommendedRibHeight,
    depth: 50,
    x: 0, y: 800, z: 650 - 50,
    // ...
  };
  panels.push(rib);
}
```

### 2.3 –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å ConstraintSolver

```typescript
// –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏ (–§–ê–ó–ê 2)
const { panels, solverResult } = generator.generateWithConstraints();

if (!solverResult.success) {
  console.error('‚ùå –†–µ—à–∞—Ç–µ–ª—å –Ω–µ —Å–æ—à–µ–ª—Å—è:', {
    iterations: solverResult.iterations,
    error: solverResult.error,
    message: solverResult.message
  });
} else {
  console.log('‚úÖ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞:', {
    iterations: solverResult.iterations,
    convergence: `${(solverResult.error * 1000).toFixed(2)}–º–º`
  });
  
  // –ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ä–µ—à–µ–Ω–∏–µ
  const optimizedPanels = panels.map(p => ({
    ...p,
    x: solverResult.positions.get(`panel_${p.id}`)?.x ?? p.x,
    y: solverResult.positions.get(`panel_${p.id}`)?.y ?? p.y,
    z: solverResult.positions.get(`panel_${p.id}`)?.z ?? p.z
  }));
}
```

---

## 3. ConstraintSolver –ø—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞

### 3.1 –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —è–¥—Ä–æ

```typescript
import { ConstraintSolver } from './services/ConstraintSolver';
import { Assembly, Component, Constraint, ConstraintType } from './types/CADTypes';

// –°–æ–∑–¥–∞—Ç—å —Å–±–æ—Ä–∫—É —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏
const assembly: Assembly = {
  id: 'cabinet-1',
  name: '–®–∫–∞—Ñ-–∫—É–ø–µ',
  components: [
    {
      id: 'body-left',
      name: '–ë–æ–∫–æ–≤–∞—è —Å—Ç–µ–Ω–∫–∞ –ª–µ–≤–∞—è',
      type: 'body',
      position: { x: 0, y: 0, z: 0 },
      dimensions: { width: 650, height: 2200, depth: 16 },
      material: { id: 'eg-w980', name: 'Egger White Oak' }
    },
    {
      id: 'body-right',
      name: '–ë–æ–∫–æ–≤–∞—è —Å—Ç–µ–Ω–∫–∞ –ø—Ä–∞–≤–∞—è',
      type: 'body',
      position: { x: 2400, y: 0, z: 0 },  // –ò–∑–Ω–∞—á–∞–ª—å–Ω–æ –Ω–µ–≤–µ—Ä–Ω–æ
      dimensions: { width: 650, height: 2200, depth: 16 },
      material: { id: 'eg-w980', name: 'Egger White Oak' }
    },
    {
      id: 'shelf-1',
      name: '–ü–æ–ª–∫–∞ 1',
      type: 'shelf',
      position: { x: 0, y: 800, z: 0 },
      dimensions: { width: 2400, height: 16, depth: 650 },
      material: { id: 'eg-w980', name: 'Egger White Oak' }
    }
  ],
  constraints: [
    // –õ–µ–≤–∞—è —Å—Ç–µ–Ω–∫–∞ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–∞
    {
      id: 'fix-left',
      type: ConstraintType.FIXED,
      component1Id: 'body-left',
      targetValue: { x: 0, y: 0, z: 0 }
    },
    // –ü—Ä–∞–≤–∞—è —Å—Ç–µ–Ω–∫–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –Ω–∞ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–∏ 2400–º–º –æ—Ç –ª–µ–≤–æ–π
    {
      id: 'dist-sides',
      type: ConstraintType.DISTANCE,
      component1Id: 'body-left',
      component2Id: 'body-right',
      targetValue: 2400
    },
    // –ü–æ–ª–∫–∞ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞ –æ—Å–∏ X
    {
      id: 'parallel-shelf',
      type: ConstraintType.PARALLEL,
      component1Id: 'shelf-1',
      component2Id: 'body-left'
    },
    // –ü–æ–ª–∫–∞ –Ω–∞ 800–º–º –æ—Ç –¥–Ω–∞
    {
      id: 'dist-shelf-bottom',
      type: ConstraintType.DISTANCE,
      component1Id: 'body-left',
      component2Id: 'shelf-1',
      targetValue: 800
    }
  ]
};

// –†–µ—à–∏—Ç—å —Å–∏—Å—Ç–µ–º—É
const solver = new ConstraintSolver();
const initialPositions = new Map([
  ['body-left', { x: 0, y: 0, z: 0 }],
  ['body-right', { x: 2400, y: 0, z: 0 }],  // –ú–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–≤–µ—Ä–Ω–æ
  ['shelf-1', { x: 0, y: 800, z: 0 }]
]);

const result = solver.solve(assembly, initialPositions, {
  tolerance: 0.001,      // 0.001–º–º —Ç–æ—á–Ω–æ—Å—Ç—å
  maxIterations: 100,
  verbose: true
});

if (result.success && result.converged) {
  console.log(`‚úÖ –°–æ—à–µ–ª—Å—è –∑–∞ ${result.iterations} –∏—Ç–µ—Ä–∞—Ü–∏–π`);
  console.log('–ù–æ–≤—ã–µ –ø–æ–∑–∏—Ü–∏–∏:');
  for (const [componentId, pos] of result.positions) {
    console.log(`  ${componentId}: (${pos.x.toFixed(2)}, ${pos.y.toFixed(2)}, ${pos.z.toFixed(2)})`);
  }
} else {
  console.error('‚ùå –ù–µ —Å–æ—à–µ–ª—Å—è:');
  for (const [constraintId, error] of result.constraintErrors) {
    console.log(`  –û—à–∏–±–∫–∞ ${constraintId}: ${error.toFixed(4)}–º–º`);
  }
}
```

### 3.2 Newton-Raphson –ø—Ä–æ—Ü–µ—Å—Å

```typescript
// –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∏—Ç–µ—Ä–∞—Ü–∏–π
interface IterationLog {
  iteration: number;
  residual: number;
  maxConstraintError: number;
  positions: Map<string, { x: number; y: number; z: number }>;
}

const iterationLogs: IterationLog[] = [];

// –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π solve() —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º
const result = solver.solve(assembly, initialPositions, { verbose: true });

// –í—ã–≤–æ–¥ –ø—Ä–æ—Ü–µ—Å—Å–∞ —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏:
// [Solver] Iteration 0: residual = 2.451238
// [Solver] Iteration 1: residual = 0.824510
// [Solver] Iteration 2: residual = 0.052341
// [Solver] Iteration 3: residual = 0.001223
// [Solver] Iteration 4: residual = 0.000001
// ‚úÖ –°–æ—à–µ–ª—Å—è –∑–∞ 5 –∏—Ç–µ—Ä–∞—Ü–∏–π
```

---

## 4. geminiService –ø—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞

### 4.1 –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

```typescript
import { initializeGemini, generateDesignFromDescription } from './services/geminiService';

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å Gemini —Å API –∫–ª—é—á–æ–º
await initializeGemini(process.env.VITE_GEMINI_API_KEY);

// –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–∏—à–µ—Ç –Ω–∞ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–º —è–∑—ã–∫–µ
const userInput = `
  –ú–Ω–µ –Ω—É–∂–µ–Ω —à–∫–∞—Ñ-–∫—É–ø–µ –¥–ª—è —Å–ø–∞–ª—å–Ω–∏.
  –®–∏—Ä–∏–Ω–∞ 2400–º–º, –≤—ã—Å–æ—Ç–∞ 2200–º–º, –≥–ª—É–±–∏–Ω–∞ 650–º–º.
  –î–≤–µ —Ä–∞–∑–¥–≤–∏–∂–Ω—ã–µ –¥–≤–µ—Ä–∏.
  –í–Ω—É—Ç—Ä–∏ 3 –æ—Ç–¥–µ–ª–µ–Ω–∏—è:
  - –ü–µ—Ä–≤–æ–µ –æ—Ç–¥–µ–ª–µ–Ω–∏–µ: –≤–µ—à–∞–ª–∫–∞ –¥–ª—è –ø–∞–ª—å—Ç–æ
  - –í—Ç–æ—Ä–æ–µ –æ—Ç–¥–µ–ª–µ–Ω–∏–µ: 5 –ø–æ–ª–æ–∫ –¥–ª—è –æ–¥–µ–∂–¥—ã
  - –¢—Ä–µ—Ç—å–µ –æ—Ç–¥–µ–ª–µ–Ω–∏–µ: 2 —è—â–∏–∫–∞ –∏ –ø–æ–ª–∫–∏
`;

try {
  const result = await generateDesignFromDescription(userInput);
  
  if (!result.success) {
    console.error('‚ùå –û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏:', result.error);
  } else {
    const { config, sections, optimization } = result.data;
    
    console.log(`‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–∞:`);
    console.log(`   –ò–º—è: ${config.name}`);
    console.log(`   –†–∞–∑–º–µ—Ä—ã: ${config.width}x${config.height}x${config.depth}`);
    console.log(`   –¢–∏–ø –¥–≤–µ—Ä–µ–π: ${config.doorType}`);
    console.log(`   –û—Ç–¥–µ–ª–µ–Ω–∏—è: ${sections.length}`);
    
    // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
    const generator = new CabinetGenerator(config, sections, MATERIAL_LIBRARY);
    const panels = generator.generate();
  }
} catch (error) {
  if (error.code === 'QUOTA_EXCEEDED') {
    console.error('‚è≥ –ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤. –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ 5 —Å–µ–∫...');
    await new Promise(r => setTimeout(r, 5000));
  } else if (error.code === 'SAFETY_VIOLATION') {
    console.error('üö´ –ó–∞–ø—Ä–æ—Å –æ—Ç–∫–ª–æ–Ω–µ–Ω —Ñ–∏–ª—å—Ç—Ä–∞–º–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏');
  } else {
    console.error('‚ùå –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞:', error.message);
  }
}
```

### 4.2 –ê—É–¥–∏—Ç –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏

```typescript
import { auditConstruction } from './services/geminiService';

const auditResult = await auditConstruction(panels, config);

// –†–µ–∑—É–ª—å—Ç–∞—Ç –∏–º–µ–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É:
{
  softCheck: {
    warnings: [
      {
        type: 'EFFICIENCY',
        message: '–ü–æ–ª–∫–∞ 1200–º–º –Ω–∞ –≥–ª—É–±–∏–Ω–µ 650–º–º –±—É–¥–µ—Ç –ø—Ä–æ–≤–∏—Å–∞—Ç—å –Ω–∞ 2.8–º–º –ø—Ä–∏ –Ω–∞–≥—Ä—É–∑–∫–µ 40–∫–≥',
        severity: 'WARNING',
        suggestion: '–î–æ–±–∞–≤—å—Ç–µ –ø—Ä–æ–¥–æ–ª—å–Ω–æ–µ —É—Å–∏–ª–µ–Ω–∏–µ –∏–ª–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â—É—é –Ω–∞–ø—Ä–∞–≤–ª—è—é—â—É—é'
      }
    ]
  },
  hardCheck: {
    errors: [
      {
        type: 'SAFETY',
        message: '–ß–µ—Ç—ã—Ä–µ –ø–µ—Ç–ª–∏ –Ω–∞ –¥–≤–µ—Ä–∏ 2200–º–º –≤—ã—Å–æ—Ç–æ–π ‚Äî –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ (—Ç—Ä–µ–±—É–µ—Ç—Å—è 5)',
        severity: 'ERROR',
        suggestion: '–î–æ–±–∞–≤—å—Ç–µ 5-—é –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—É—é –ø–µ—Ç–ª—é'
      }
    ]
  },
  optimization: {
    recommendations: [
      {
        area: 'cost',
        message: '–ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—â–∏–Ω—É 18–º–º –≤–º–µ—Å—Ç–æ 22–º–º –∏ —Å—ç–∫–æ–Ω–æ–º–∏—Ç—å 12%',
        potential_saving: '8500‚ÇΩ'
      }
    ]
  }
}

// –í—ã–≤–µ—Å—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
console.log('üîç –ê—É–¥–∏—Ç –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏:');
if (auditResult.hardCheck.errors.length > 0) {
  console.log('‚ùå –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –û–®–ò–ë–ö–ò:');
  auditResult.hardCheck.errors.forEach(e => {
    console.log(`   - ${e.message}`);
    console.log(`     üí° ${e.suggestion}`);
  });
}
if (auditResult.softCheck.warnings.length > 0) {
  console.log('‚ö†Ô∏è –ü–†–ï–î–£–ü–†–ï–ñ–î–ï–ù–ò–Ø:');
  auditResult.softCheck.warnings.forEach(w => {
    console.log(`   - ${w.message}`);
  });
}
```

### 4.3 –≠–∫—Å–ø–µ—Ä—Ç–Ω—ã–µ —Å–æ–≤–µ—Ç—ã

```typescript
import { askExpert } from './services/geminiService';

const questions = [
  '–ö–∞–∫–∞—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –≤—ã—Å–æ—Ç–∞ –∫—É—Ö–æ–Ω–Ω–æ–≥–æ –≥–∞—Ä–Ω–∏—Ç—É—Ä–∞?',
  '–ö–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–µ—Ç–µ–ª—å –¥–ª—è –¥–≤–µ—Ä–∏?',
  '–ö–∞–∫–æ–π –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –ø—Ä–æ–ª–µ—Ç –¥–ª—è –ø–æ–ª–∫–∏ –∏–∑ –î–°–ü —Ç–æ–ª—â–∏–Ω–æ–π 16–º–º?'
];

for (const question of questions) {
  const answer = await askExpert(question);
  console.log(`‚ùì ${question}`);
  console.log(`‚ú® ${answer}\n`);
}

// –ü—Ä–∏–º–µ—Ä–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã (–Ω–∞ —Ä—É—Å—Å–∫–æ–º):
// ‚ùì –ö–∞–∫–∞—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –≤—ã—Å–æ—Ç–∞ –∫—É—Ö–æ–Ω–Ω–æ–≥–æ –≥–∞—Ä–Ω–∏—Ç—É—Ä–∞?
// ‚ú® –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –≤—ã—Å–æ—Ç–∞ –∫—É—Ö–æ–Ω–Ω–æ–≥–æ –≥–∞—Ä–Ω–∏—Ç—É—Ä–∞ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç 860-910 –º–º –æ—Ç –ø–æ–ª–∞ –¥–æ —Å—Ç–æ–ª–µ—à–Ω–∏—Ü—ã.
//    –≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —É–¥–æ–±–Ω—É—é —Ä–∞–±–æ—á—É—é –≤—ã—Å–æ—Ç—É –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –≤–∑—Ä–æ—Å–ª—ã—Ö –ª—é–¥–µ–π.
//    –í—ã—Å–æ—Ç–∞ –ø–æ–¥–≤–µ—Å–Ω–æ–≥–æ —à–∫–∞—Ñ–∞ –Ω–∞–¥ —Å—Ç–æ–ª–µ—à–Ω–∏—Ü–µ–π –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å 400-500 –º–º.
```

---

## 5. BillOfMaterials –ø—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞

### 5.1 –†–∞—Å—á–µ—Ç —Å–º–µ—Ç—ã

```typescript
import { BillOfMaterials } from './services/BillOfMaterials';
import { MATERIAL_LIBRARY } from './materials.config';

const assembly: Assembly = {
  // ... —Å–±–æ—Ä–∫–∞ —Å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏
};

const materialPrices = {
  'eg-w980': 15000,      // ‚ÇΩ –∑–∞ –º¬≥ (Egger White Oak)
  'kron-white': 12000,   // ‚ÇΩ –∑–∞ –º¬≥ (Kronospan White)
  'mdf-ral7016': 18000   // ‚ÇΩ –∑–∞ –º¬≥ (MDF RAL 7016)
};

const manufacturingOps = {
  machining: 500,        // ‚ÇΩ/—á–∞—Å
  painting: 300,         // ‚ÇΩ/—á–∞—Å
  assembly: 400,         // ‚ÇΩ/—á–∞—Å
  qualityControl: 200,   // ‚ÇΩ/—á–∞—Å
  packaging: 100         // ‚ÇΩ/–∏–∑–¥–µ–ª–∏–µ
};

const bom = new BillOfMaterials(assembly, materialPrices, manufacturingOps);

// –†–∞—Å—Å—á–∏—Ç–∞—Ç—å —Å–º–µ—Ç—É
const bomData = bom.generate();
const bomStats = bom.getStats();

console.log('üìä –°–º–µ—Ç–∞ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤:');
console.log(`   –í—Å–µ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤: ${bomStats.totalItems}`);
console.log(`   –£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Ç–∏–ø–æ–≤: ${bomStats.uniqueComponents}`);
console.log(`   –û–±—â–∞—è –º–∞—Å—Å–∞: ${bomStats.totalMass.toFixed(1)}–∫–≥`);
console.log(`   –°—Ç–æ–∏–º–æ—Å—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤: ${bomStats.materialCost.toFixed(0)}‚ÇΩ`);
console.log(`   –°—Ç–æ–∏–º–æ—Å—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞: ${bomStats.manufacturingCost.toFixed(0)}‚ÇΩ`);
console.log(`   –ò–¢–û–ì–û: ${bomStats.totalCost.toFixed(0)}‚ÇΩ`);
console.log(`   –í—Ä–µ–º—è –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞: ${bomStats.totalProductionTime.toFixed(1)}—á–∞—Å–æ–≤`);

// –≠–∫—Å–ø–æ—Ä—Ç –≤ —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã
const csvExport = bom.exportCSV();
const jsonExport = bom.exportJSON();
const excelBuffer = bom.exportExcel();
```

---

## 6. DFMValidator –ø—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞

### 6.1 –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏

```typescript
import { DFMValidator } from './services/DFMValidator';

const dfmConfig = {
  minWallThickness: 1.5,        // –º–º
  minFilletRadius: 0.5,         // –º–º
  maxAspectRatio: 10,           // –≤—ã—Å–æ—Ç–∞/—à–∏—Ä–∏–Ω–∞
  minDistanceFromEdge: 3,       // –º–º
  maxHoleDensity: 2,            // –Ω–∞ —Å–º¬≤
  minDistanceBetweenHoles: 5,   // –º–º
  maxComponentWeight: 50,       // –∫–≥
  complexityThreshold: 20       // constraints
};

const dfmValidator = new DFMValidator(dfmConfig);

// –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å —Å–±–æ—Ä–∫—É
const dfmReport = dfmValidator.validateAssembly(assembly);

console.log('üè≠ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏:');

if (dfmReport.overallStatus === 'CRITICAL') {
  console.log('‚ùå –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´:');
  dfmReport.checks
    .filter(c => c.severity === 'CRITICAL')
    .forEach(c => {
      console.log(`   ‚ùå ${c.message}`);
      console.log(`      –ö–æ–º–ø–æ–Ω–µ–Ω—Ç: ${c.componentId}`);
      if (c.suggestedFix) {
        console.log(`      üí° –†–µ—à–µ–Ω–∏–µ: ${c.suggestedFix}`);
      }
    });
}

if (dfmReport.checks.some(c => c.severity === 'ERROR')) {
  console.log('‚ö†Ô∏è –û–®–ò–ë–ö–ò:');
  dfmReport.checks
    .filter(c => c.severity === 'ERROR')
    .forEach(c => {
      console.log(`   ${c.message}`);
    });
}

// –†–∞—Å—á–µ—Ç DFM Score (0-100)
const dfmScore = dfmValidator.calculateDFMScore(dfmReport);
console.log(`\nüìà DFM Score: ${dfmScore}/100 ${
  dfmScore >= 80 ? '‚úÖ –•–æ—Ä–æ—à–æ' :
  dfmScore >= 60 ? '‚ö†Ô∏è –ü—Ä–∏–µ–º–ª–µ–º–æ' :
  '‚ùå –¢—Ä–µ–±—É–µ—Ç —É–ª—É—á—à–µ–Ω–∏–π'
}`);
```

---

## 7. ProjectStore –ø—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞

### 7.1 State Management

```typescript
import { useProjectStore } from './store/projectStore';

// –ü–æ–ª—É—á–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ
const {
  panels,
  selectedPanelId,
  history,
  solvedAssembly,
  bomData,
  dfmReport,
  currentGlobalStage,
  
  // Actions
  addPanel,
  updatePanel,
  bulkUpdatePanels,
  selectPanel,
  undo,
  redo,
  setSolvedAssembly,
  setBOMData,
  setDFMReport,
  setGlobalStage
} = useProjectStore();

// –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é –ø–∞–Ω–µ–ª—å
const newPanel: Panel = {
  id: `panel-${Date.now()}`,
  name: '–ù–æ–≤–∞—è –ø–æ–ª–∫–∞',
  width: 1200,
  height: 16,
  depth: 650,
  x: 0, y: 500, z: 0,
  materialId: 'eg-w980',
  color: '#FFFFFF',
  texture: TextureType.WOOD_OAK,
  textureRotation: 0,
  visible: true,
  layer: 'shelves',
  openingType: 'none',
  edging: { top: '2.0', bottom: '0.4', left: '0.4', right: '0.4' },
  groove: { enabled: false, side: 'top', width: 0, depth: 0, offset: 0 },
  hardware: []
};

addPanel(newPanel);

// –ú–∞—Å—Å–æ–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ (—Å –∏—Å—Ç–æ—Ä–∏–µ–π)
bulkUpdatePanels([
  {
    id: panel1.id,
    changes: { y: 800, visible: true }
  },
  {
    id: panel2.id,
    changes: { materialId: 'kron-white' }
  }
]);

// –ò—Å—Ç–æ—Ä–∏—è (Undo/Redo)
undo();  // –û—Ç–º–µ–Ω–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–µ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ
redo();  // –í–µ—Ä–Ω—É—Ç—å –æ—Ç–º–µ–Ω–µ–Ω–Ω–æ–µ

// –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã CAD –∞–Ω–∞–ª–∏–∑–∞
setSolvedAssembly(constraintSolverResult);
setBOMData(billOfMaterialsResult);
setDFMReport(dfmValidatorResult);

// –ò–∑–º–µ–Ω–∏—Ç—å —ç—Ç–∞–ø –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞
setGlobalStage('cutting');  // design -> cutting -> edging -> drilling -> ...
```

### 7.2 React Hook –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```typescript
import React from 'react';
import { useProjectStore } from './store/projectStore';

const EditorComponent: React.FC = () => {
  const { 
    panels, 
    selectedPanelId, 
    updatePanel, 
    selectPanel,
    addToast
  } = useProjectStore();

  const selectedPanel = panels.find(p => p.id === selectedPanelId);

  const handleDimensionChange = (dimension: 'width' | 'height' | 'depth', value: number) => {
    if (selectedPanelId) {
      updatePanel(selectedPanelId, { [dimension]: value });
      addToast(`–†–∞–∑–º–µ—Ä –∏–∑–º–µ–Ω–µ–Ω`, 'success');
    }
  };

  return (
    <div>
      <h2>–°–≤–æ–π—Å—Ç–≤–∞ –ø–∞–Ω–µ–ª–∏</h2>
      {selectedPanel ? (
        <>
          <input
            type="number"
            value={selectedPanel.width}
            onChange={(e) => handleDimensionChange('width', Number(e.target.value))}
            placeholder="–®–∏—Ä–∏–Ω–∞ (–º–º)"
          />
          <input
            type="number"
            value={selectedPanel.height}
            onChange={(e) => handleDimensionChange('height', Number(e.target.value))}
            placeholder="–í—ã—Å–æ—Ç–∞ (–º–º)"
          />
          <input
            type="number"
            value={selectedPanel.depth}
            onChange={(e) => handleDimensionChange('depth', Number(e.target.value))}
            placeholder="–ì–ª—É–±–∏–Ω–∞ (–º–º)"
          />
        </>
      ) : (
        <p>–í—ã–±–µ—Ä–∏—Ç–µ –ø–∞–Ω–µ–ª—å –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</p>
      )}
    </div>
  );
};

export default EditorComponent;
```

---

## 8. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π workflow

### –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —à–∫–∞—Ñ–∞

```typescript
import { CabinetGenerator } from './services/CabinetGenerator';
import { ConstraintSolver } from './services/ConstraintSolver';
import { BillOfMaterials } from './services/BillOfMaterials';
import { DFMValidator } from './services/DFMValidator';
import { auditConstruction, generateDesignFromDescription } from './services/geminiService';
import { useProjectStore } from './store/projectStore';

// –≠–¢–ê–ü 1: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
async function designCabinet() {
  console.log('1Ô∏è‚É£ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏...');
  const designResult = await generateDesignFromDescription(userInput);
  const { config, sections } = designResult.data;

  // –≠–¢–ê–ü 2: –°–æ–∑–¥–∞–Ω–∏–µ 3D –º–æ–¥–µ–ª–∏
  console.log('2Ô∏è‚É£ –°–æ–∑–¥–∞–Ω–∏–µ 3D –º–æ–¥–µ–ª–∏...');
  const generator = new CabinetGenerator(config, sections, MATERIAL_LIBRARY);
  const panels = generator.generate();
  
  // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ store
  const { setPanels } = useProjectStore.getState();
  setPanels(panels);

  // –≠–¢–ê–ü 3: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ–∑–∏—Ü–∏–π (ConstraintSolver)
  console.log('3Ô∏è‚É£ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è...');
  const { panels: optimizedPanels, solverResult } = 
    generator.generateWithConstraints();
  
  if (solverResult.success) {
    setPanels(optimizedPanels);
  } else {
    throw new Error('Solver –Ω–µ —Å–æ—à–µ–ª—Å—è');
  }

  // –≠–¢–ê–ü 4: –†–∞—Å—á–µ—Ç —Å–º–µ—Ç—ã –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤
  console.log('4Ô∏è‚É£ –†–∞—Å—á–µ—Ç —Å–º–µ—Ç—ã...');
  const assembly = generator.generateAssembly();
  const bom = new BillOfMaterials(assembly, MATERIAL_PRICES);
  const bomData = bom.generate();
  
  const { setBOMData } = useProjectStore.getState();
  setBOMData(bomData);

  // –≠–¢–ê–ü 5: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏
  console.log('5Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∫–∞ DFM...');
  const dfmValidator = new DFMValidator(DFM_CONFIG);
  const dfmReport = dfmValidator.validateAssembly(assembly);
  
  const { setDFMReport } = useProjectStore.getState();
  setDFMReport(dfmReport);

  // –≠–¢–ê–ü 6: AI –∞—É–¥–∏—Ç –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
  console.log('6Ô∏è‚É£ AI –∞—É–¥–∏—Ç...');
  const auditReport = await auditConstruction(optimizedPanels, config);
  
  if (auditReport.hardCheck.errors.length > 0) {
    console.warn('‚ö†Ô∏è –ù–∞–π–¥–µ–Ω—ã –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏. –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–æ—Ä–∞–±–æ—Ç–∫–∞.');
    return { success: false, errors: auditReport.hardCheck.errors };
  }

  // ‚úÖ –£–°–ü–ï–®–ù–û
  console.log('‚úÖ –ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ!');
  return {
    success: true,
    panels: optimizedPanels,
    bom: bomData,
    dfm: dfmReport,
    audit: auditReport
  };
}

// –ó–∞–ø—É—Å—Ç–∏—Ç—å
try {
  const result = await designCabinet();
  if (result.success) {
    console.log('üìä –§–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç:');
    console.log(`   –ü–∞–Ω–µ–ª–µ–π: ${result.panels.length}`);
    console.log(`   –ú–∞—Ç–µ—Ä–∏–∞–ª–æ–≤: ${result.bom.totalItems}`);
    console.log(`   –°—Ç–æ–∏–º–æ—Å—Ç—å: ${result.bom.totalCost}‚ÇΩ`);
    console.log(`   DFM Score: ${result.dfm.score}/100`);
  }
} catch (error) {
  console.error('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏:', error.message);
}
```

---

## 9. Performance Tips

### 9.1 –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è CabinetGenerator

```typescript
// ‚ùå –ü–õ–û–•–û: –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ø–µ—Ä–µ—Å–æ–∑–¥–∞–µ—Ç—Å—è –∫–∞–∂–¥—ã–π —Ä–∞–∑
function generateDesign(config) {
  const gen = new CabinetGenerator(config, sections, materials);
  return gen.generate();
}

// ‚úÖ –•–û–†–û–®–û: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ
class DesignCache {
  private cache = new Map<string, Panel[]>();
  
  generate(config: CabinetConfig): Panel[] {
    const key = JSON.stringify(config);
    if (this.cache.has(key)) {
      return this.cache.get(key)!;
    }
    
    const gen = new CabinetGenerator(config, sections, materials);
    const result = gen.generate();
    this.cache.set(key, result);
    return result;
  }
}
```

### 9.2 –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è

```typescript
// –ó–∞–ø—É—Å—Ç–∏—Ç—å BOM, DFM –∏ FEA –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ (–Ω–µ –∂–¥–∞—Ç—å –¥—Ä—É–≥ –¥—Ä—É–≥–∞)
async function analyzeAssembly(assembly: Assembly) {
  const [bomData, dfmReport, feaResults] = await Promise.all([
    billOfMaterials.calculate(assembly),
    dfmValidator.validate(assembly),
    feaIntegration.analyze(assembly)
  ]);
  
  return { bomData, dfmReport, feaResults };
}
```

### 9.3 Web Worker –¥–ª—è —Ç—è–∂–µ–ª—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π

```typescript
// –ó–∞–ø—É—Å—Ç–∏—Ç—å Constraint Solver –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø–æ—Ç–æ–∫–µ
const solverWorker = new Worker('constraint-solver.worker.ts');

solverWorker.postMessage({
  assembly: assembly,
  initialPositions: positions
});

solverWorker.onmessage = (event) => {
  const solverResult = event.data;
  console.log('Solver –∑–∞–≤–µ—Ä—à–∏–ª:', solverResult);
};
```

---

## 10. –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏ –∏ –∏—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### –û—à–∏–±–∫–∞ 1: –ó–∞–±—ã–ª–∏ –∏–Ω–≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –∫–µ—à

```typescript
// ‚ùå –û–®–ò–ë–ö–ê
const gen = new CabinetGenerator(config1, ...);
gen.generate();  // –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–ª—è config1

// –ì–¥–µ-—Ç–æ –∏–∑–º–µ–Ω–∏–ª—Å—è config1
config1.width = 3000;

gen.generate();  // ‚ùå –í–µ—Ä–Ω–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–ª—è —Å—Ç–∞—Ä–æ–≥–æ config, –ø–∞—Ä–∞–º–µ—Ç–µ—Ä–Ω—ã–π –∫–µ—à –Ω–µ –∏–Ω–≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞–Ω
```

**–†–µ—à–µ–Ω–∏–µ**: –¥–æ–±–∞–≤–∏—Ç—å —è–≤–Ω—É—é –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—é –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–æ–≤—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞.

### –û—à–∏–±–∫–∞ 2: –ù–µ–≤–µ—Ä–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –µ–¥–∏–Ω–∏—Ü

```typescript
// ‚ùå –û–®–ò–ë–ö–ê (—Å–º–µ—à–∏–≤–∞–Ω–∏–µ –º–µ—Ç—Ä–æ–≤ –∏ –º–∏–ª–ª–∏–º–µ—Ç—Ä–æ–≤)
const config = {
  width: 2.4,     // –•–æ—Ç–µ–ª —Å–∫–∞–∑–∞—Ç—å 2.4–º = 2400–º–º
  // –ù–æ —Å–∏—Å—Ç–µ–º–∞ –æ–∂–∏–¥–∞–µ—Ç –º–º!
};

// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û
const config = {
  width: 2400,    // –º–º (—è–≤–Ω–æ —É–∫–∞–∑—ã–≤–∞–µ–º –º–º)
};
```

### –û—à–∏–±–∫–∞ 3: –ó–∞–±—ã–ª–∏ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –æ—à–∏–±–∫–∏ Gemini

```typescript
// ‚ùå –û–®–ò–ë–ö–ê
const result = await generateDesign(input);  // –ú–æ–∂–µ—Ç —É–ø–∞—Å—Ç—å

// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û
try {
  const result = await generateDesign(input);
} catch (error) {
  if (error.code === 'QUOTA_EXCEEDED') {
    // –ñ–¥–∞—Ç—å –∏ –ø–æ–≤—Ç–æ—Ä–∏—Ç—å
  } else if (error.code === 'SAFETY_VIOLATION') {
    // –ò–∑–º–µ–Ω–∏—Ç—å –∑–∞–ø—Ä–æ—Å
  } else {
    // –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –∏ –ø–æ–∫–∞–∑–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
  }
}
```

