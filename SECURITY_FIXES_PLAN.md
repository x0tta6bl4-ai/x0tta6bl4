# üîí –ü–õ–ê–ù –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø –ö–†–ò–¢–ò–ß–ï–°–ö–ò–• –£–Ø–ó–í–ò–ú–û–°–¢–ï–ô –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò
## x0tta6bl4 Security Remediation Plan

**–î–∞—Ç–∞:** 29 —è–Ω–≤–∞—Ä—è 2026  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** P0 ‚Äî –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π  
**–°—Ä–æ–∫:** 3-5 –¥–Ω–µ–π  
**–û—Ü–µ–Ω–∫–∞:** 14-18 —á–∞—Å–æ–≤

---

## üìã –ö–ê–¢–ï–ì–û–†–ò–ò –£–Ø–ó–í–ò–ú–û–°–¢–ï–ô

### –ö–∞—Ç–µ–≥–æ—Ä–∏—è 1: SQL-–∏–Ω—ä–µ–∫—Ü–∏–∏ (CWE-89)
**–†–∏—Å–∫:** –í—ã—Å–æ–∫–∏–π | **CVSS:** 8.1 | **–°—Ç–∞—Ç—É—Å:** –¢—Ä–µ–±—É–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏

#### –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:
- [ ] `src/api/billing.py` ‚Äî –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∞—Ü–∏—é –∑–∞–ø—Ä–æ—Å–æ–≤
- [ ] `src/api/users.py` ‚Äî –ø—Ä–æ–≤–µ—Ä–∏—Ç—å SQLAlchemy ORM –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
- [ ] `src/dao/` –º–æ–¥—É–ª–∏ ‚Äî –∞—É–¥–∏—Ç raw SQL

#### –ü–ª–∞–Ω –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
```python
# –ü–ï–†–ï–î (–æ–ø–∞—Å–Ω–æ):
cursor.execute(f"SELECT * FROM users WHERE id = {user_id}")

# –ü–û–°–õ–ï (–±–µ–∑–æ–ø–∞—Å–Ω–æ):
cursor.execute("SELECT * FROM users WHERE id = %s", (user_id,))
```

**–í—Ä–µ–º—è:** 3-4 —á–∞—Å–∞  
**–¢–µ—Å—Ç—ã:** `pytest tests/security/test_sql_injection.py -v`

---

### –ö–∞—Ç–µ–≥–æ—Ä–∏—è 2: RCE —á–µ—Ä–µ–∑ subprocess (CWE-78)
**–†–∏—Å–∫:** –í—ã—Å–æ–∫–∏–π | **CVSS:** 7.8 | **–°—Ç–∞—Ç—É—Å:** 101 –≤—ã–∑–æ–≤ —Ç—Ä–µ–±—É–µ—Ç –∞—É–¥–∏—Ç–∞

#### –ü—Ä–æ–±–ª–µ–º–Ω—ã–µ —Ñ–∞–π–ª—ã:
- [ ] `src/deployment/multi_cloud_deployment.py` ‚Äî 15+ –≤—ã–∑–æ–≤–æ–≤
- [ ] `src/deployment/canary_deployment.py` ‚Äî 5+ –≤—ã–∑–æ–≤–æ–≤
- [ ] `src/licensing/node_identity.py` ‚Äî 3 –≤—ã–∑–æ–≤–∞
- [ ] `src/core/` ‚Äî —Ä–∞–∑–ª–∏—á–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã

#### –ü–ª–∞–Ω –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
```python
# –ü–ï–†–ï–î (–æ–ø–∞—Å–Ω–æ):
subprocess.run(f"docker push {image_name}", shell=True)

# –ü–û–°–õ–ï (–±–µ–∑–æ–ø–∞—Å–Ω–æ):
subprocess.run(
    ["docker", "push", image_name],
    shell=False,
    check=True,
    capture_output=True
)
```

**–í—Ä–µ–º—è:** 6-8 —á–∞—Å–æ–≤  
**–¢–µ—Å—Ç—ã:** `pytest tests/security/test_command_injection.py -v`

---

### –ö–∞—Ç–µ–≥–æ—Ä–∏—è 3: –û–±—Ö–æ–¥ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (CWE-287)
**–†–∏—Å–∫:** –°—Ä–µ–¥–Ω–∏–π | **CVSS:** 6.5 | **–°—Ç–∞—Ç—É—Å:** –ß–∞—Å—Ç–∏—á–Ω–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

#### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å:
- [ ] `src/api/users.py:184-190` ‚Äî verify_admin_token
- [ ] –í—Å–µ endpoints —Å `@limiter` ‚Äî –ø—Ä–æ–≤–µ—Ä–∏—Ç—å bypass scenarios
- [ ] API keys validation ‚Äî –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —É—Ç–µ—á–∫–∏

#### –ü–ª–∞–Ω –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
```python
# –î–æ–±–∞–≤–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏:
async def verify_admin_token(x_admin_token: Optional[str] = Header(None)):
    if not x_admin_token:
        raise HTTPException(status_code=403, detail="Token required")
    
    # –î–æ–±–∞–≤–∏—Ç—å rate limiting –¥–ª—è admin endpoints
    # –î–æ–±–∞–≤–∏—Ç—å audit logging
    # –î–æ–±–∞–≤–∏—Ç—å token expiration check
```

**–í—Ä–µ–º—è:** 2-3 —á–∞—Å–∞  
**–¢–µ—Å—Ç—ã:** `pytest tests/security/test_auth_bypass.py -v`

---

### –ö–∞—Ç–µ–≥–æ—Ä–∏—è 4: MD5 –≤ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏–∏ (CWE-327)
**–†–∏—Å–∫:** –°—Ä–µ–¥–Ω–∏–π | **CVSS:** 5.3 | **–°—Ç–∞—Ç—É—Å:** 1 –ª–æ–∫–∞—Ü–∏—è

#### –õ–æ–∫–∞—Ü–∏—è:
- [ ] `src/security/password_migration.py:138`

#### –ü–ª–∞–Ω –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
```python
# –£–î–ê–õ–ò–¢–¨ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏—é legacy_verify_md5
# –ü—Ä–∏–Ω—É–¥–∏—Ç—å –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å MD5 —Å–±—Ä–æ—Å–∏—Ç—å –ø–∞—Ä–æ–ª—å
# –î–æ–±–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø—Ä–∏ –≤—Ö–æ–¥–µ
```

**–í—Ä–µ–º—è:** 2 —á–∞—Å–∞  
**–¢–µ—Å—Ç—ã:** `pytest tests/security/test_password_hashing.py -v`

---

### –ö–∞—Ç–µ–≥–æ—Ä–∏—è 5: Hardcoded credentials (CWE-798)
**–†–∏—Å–∫:** –°—Ä–µ–¥–Ω–∏–π | **CVSS:** 4.0 | **–°—Ç–∞—Ç—É—Å:** 57 –ª–æ–∫–∞—Ü–∏–π

#### –ü—Ä–æ–±–ª–µ–º–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã:
```python
# –ù–∞–π–¥–µ–Ω–æ –≤ –∫–æ–¥–µ:
"localhost:8080"
"0.0.0.0:50051"
"http://localhost:9090"
"127.0.0.1"
```

#### –ü–ª–∞–Ω –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
```python
# –í—ã–Ω–µ—Å—Ç–∏ –≤ settings.py:
class Settings(BaseSettings):
    api_host: str = Field(default="127.0.0.1", env="API_HOST")
    prometheus_url: str = Field(default="http://localhost:9090", env="PROMETHEUS_URL")
```

**–í—Ä–µ–º—è:** 4 —á–∞—Å–∞  
**–¢–µ—Å—Ç—ã:** `pytest tests/security/test_no_hardcoded.py -v`

---

## üéØ –ü–û–†–Ø–î–û–ö –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø

### –î–µ–Ω—å 1 (4-6 —á–∞—Å–æ–≤)
1. **SQL-–∏–Ω—ä–µ–∫—Ü–∏–∏** ‚Äî –∞—É–¥–∏—Ç –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (3-4—á)
2. **MD5 —É–¥–∞–ª–µ–Ω–∏–µ** ‚Äî –ø–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ (2—á)

### –î–µ–Ω—å 2 (6-8 —á–∞—Å–æ–≤)
3. **Subprocess RCE** ‚Äî –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –≤—ã–∑–æ–≤–æ–≤ (6-8—á)

### –î–µ–Ω—å 3 (4 —á–∞—Å–∞)
4. **Hardcoded values** ‚Äî –≤—ã–Ω–µ—Å—Ç–∏ –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é (4—á)
5. **Auth bypass** ‚Äî —É—Å–∏–ª–µ–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–æ–∫ (2-3—á)

---

## üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –ü–û–°–õ–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô

```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö security —Ç–µ—Å—Ç–æ–≤
pytest tests/security/ -v --tb=short

# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –Ω–∞ SQL –∏–Ω—ä–µ–∫—Ü–∏–∏
pytest tests/security/test_sql_injection.py -v

# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –Ω–∞ command injection
pytest tests/security/test_command_injection.py -v

# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –Ω–∞ auth bypass
pytest tests/security/test_auth_bypass.py -v

# –ü–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä —Ç–µ—Å—Ç–æ–≤
pytest tests/ -v -k "security" --cov=src --cov-report=term-missing
```

---

## üìä –ú–ï–¢–†–ò–ö–ò –£–°–ü–ï–•–ê

| –ú–µ—Ç—Ä–∏–∫–∞ | –î–æ | –ü–æ—Å–ª–µ | –¶–µ–ª—å |
|---------|-----|-------|------|
| SQL injection points | ? | 0 | 0 |
| Unsafe subprocess | 101 | 0 | 0 |
| MD5 usage | 1 | 0 | 0 |
| Hardcoded values | 57 | 0 | 0 |
| Security test coverage | ? | 100% | 100% |

---

## ‚ö†Ô∏è –û–ë–†–ê–¢–ù–ê–Ø –°–û–í–ú–ï–°–¢–ò–ú–û–°–¢–¨

### –õ–æ–º–∞—é—â–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:
1. **–£–¥–∞–ª–µ–Ω–∏–µ MD5** ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å legacy –ø–∞—Ä–æ–ª—è–º–∏ –¥–æ–ª–∂–Ω—ã —Å–±—Ä–æ—Å–∏—Ç—å –ø–∞—Ä–æ–ª—å
2. **Subprocess –≤–∞–ª–∏–¥–∞—Ü–∏—è** ‚Äî –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Å–∫—Ä–∏–ø—Ç—ã –º–æ–≥—É—Ç —Ç—Ä–µ–±–æ–≤–∞—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

### –ú–∏–≥—Ä–∞—Ü–∏—è:
```python
# –î–æ–±–∞–≤–∏—Ç—å –≤ CHANGELOG.md:
## Breaking Changes
- MD5 password verification removed ‚Äî users must reset passwords
- Subprocess calls now require explicit allow-list
```

---

## ‚úÖ CHECKLIST

- [ ] SQL-–∏–Ω—ä–µ–∫—Ü–∏–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã
- [ ] RCE —á–µ—Ä–µ–∑ subprocess —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã
- [ ] MD5 –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–∞–ª—ë–Ω
- [ ] Hardcoded values –≤—ã–Ω–µ—Å–µ–Ω—ã –≤ –∫–æ–Ω—Ñ–∏–≥
- [ ] Auth bypass —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã
- [ ] –í—Å–µ security —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞
- [ ] CHANGELOG.md –æ–±–Ω–æ–≤–ª—ë–Ω

---

**–ù–∞—á–∞–ª–æ:** 29 —è–Ω–≤–∞—Ä—è 2026  
**–û–∂–∏–¥–∞–µ–º–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ:** 31 —è–Ω–≤–∞—Ä—è - 1 —Ñ–µ–≤—Ä–∞–ª—è 2026  
**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π:** Security Lead + Backend Engineers