# ü§ñ x0tta6bl4 Telegram Bot

Telegram –±–æ—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è VPN –ø–æ–¥–ø–∏—Å–∫–∞–º–∏ –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ñ–∏–≥–æ–≤.

---

## üìã –§—É–Ω–∫—Ü–∏–∏

### –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:
- `/start` ‚Äî –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
- `/trial` ‚Äî 7 –¥–Ω–µ–π –±–µ—Å–ø–ª–∞—Ç–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
- `/subscribe` ‚Äî –ü–æ–¥–ø–∏—Å–∫–∞ $10/–º–µ—Å
- `/config` ‚Äî –ü–æ–ª—É—á–∏—Ç—å VPN –∫–æ–Ω—Ñ–∏–≥ (—Å QR –∫–æ–¥–æ–º)
- `/status` ‚Äî –°—Ç–∞—Ç—É—Å –ø–æ–¥–ø–∏—Å–∫–∏
- `/help` ‚Äî –°–ø—Ä–∞–≤–∫–∞

### –î–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞:
- `/admin_stats` ‚Äî –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- `/admin_users` ‚Äî –°–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- `/admin_user <id>` ‚Äî –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ

---

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```bash
pip3 install -r requirements_bot.txt
```

### 2. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö

```bash
python3 -c "from database import init_database; init_database()"
```

### 3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
export TELEGRAM_BOT_TOKEN="—Ç–≤–æ–π_—Ç–æ–∫–µ–Ω_–æ—Ç_BotFather"
export TELEGRAM_PAYMENT_TOKEN="—Ç–æ–∫–µ–Ω_–ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞"  # –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
export ADMIN_USER_ID="—Ç–≤–æ–π_telegram_user_id"  # –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
```

### 4. –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞

```bash
python3 telegram_bot.py
```

–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å deployment —Å–∫—Ä–∏–ø—Ç:

```bash
sudo ./deploy_bot.sh
```

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
telegram_bot.py              # –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª –±–æ—Ç–∞
database.py                  # –ú–æ–¥—É–ª—å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
vpn_config_generator.py      # –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä VPN –∫–æ–Ω—Ñ–∏–≥–æ–≤
qr_code_generator.py         # –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä QR –∫–æ–¥–æ–≤
admin_commands.py            # –ê–¥–º–∏–Ω –∫–æ–º–∞–Ω–¥—ã
health_check.py              # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
expired_subscriptions_checker.py  # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å—Ç–µ–∫—à–∏—Ö –ø–æ–¥–ø–∏—Å–æ–∫
backup_database.sh           # –°–∫—Ä–∏–ø—Ç —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
deploy_bot.sh                # –°–∫—Ä–∏–ø—Ç –¥–µ–ø–ª–æ—è
```

---

## üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è SQLite (`x0tta6bl4_users.db`).

**–¢–∞–±–ª–∏—Ü—ã:**
- `users` ‚Äî –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏ –ø–æ–¥–ø–∏—Å–∫–∏
- `payments` ‚Äî –ò—Å—Ç–æ—Ä–∏—è –ø–ª–∞—Ç–µ–∂–µ–π
- `activity_log` ‚Äî –õ–æ–≥ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

**–†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ:**
```bash
./backup_database.sh
```

Backups —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `backups/` (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 30).

---

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### Systemd Service

–ü–æ—Å–ª–µ `deploy_bot.sh` –±–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ systemd service:

```bash
systemctl status x0tta6bl4-bot
systemctl restart x0tta6bl4-bot
journalctl -u x0tta6bl4-bot -f
```

### Cron Jobs

–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏:

```bash
./crontab_setup.sh
```

**–ó–∞–¥–∞—á–∏:**
- –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π backup (2 AM)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å—Ç–µ–∫—à–∏—Ö –ø–æ–¥–ø–∏—Å–æ–∫ (3 AM)
- Health check (–∫–∞–∂–¥—ã–π —á–∞—Å)

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### Health Check

```bash
python3 health_check.py
```

–ü—Ä–æ–≤–µ—Ä—è–µ—Ç:
- ‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ VPN –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä
- ‚úÖ QR –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä
- ‚úÖ –ê–¥–º–∏–Ω –∫–æ–º–∞–Ω–¥—ã

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å—Ç–µ–∫—à–∏—Ö –ø–æ–¥–ø–∏—Å–æ–∫

```bash
python3 expired_subscriptions_checker.py
```

---

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

–ê–¥–º–∏–Ω –º–æ–∂–µ—Ç –ø–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —á–µ—Ä–µ–∑ `/admin_stats` –∏–ª–∏:

```bash
python3 -c "from database import get_user_stats; print(get_user_stats())"
```

---

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –¢–æ–∫–µ–Ω –±–æ—Ç–∞ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
- –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è —á—Ç–µ–Ω–∏—è/–∑–∞–ø–∏—Å–∏ –≤–ª–∞–¥–µ–ª—å—Ü–µ–º
- –ê–¥–º–∏–Ω –∫–æ–º–∞–Ω–¥—ã –¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É
- –†–µ–≥—É–ª—è—Ä–Ω—ã–µ backups –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

---

## üêõ Troubleshooting

### –ë–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
journalctl -u x0tta6bl4-bot -n 50

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–æ–∫–µ–Ω
echo $TELEGRAM_BOT_TOKEN

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
systemctl restart x0tta6bl4-bot
```

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

```bash
# –ü–µ—Ä–µ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å
python3 -c "from database import init_database; init_database()"

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
ls -la x0tta6bl4_users.db
```

### VPN –∫–æ–Ω—Ñ–∏–≥–∏ –Ω–µ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–æ–¥—É–ª—å
python3 -c "from vpn_config_generator import generate_vless_link; print(generate_vless_link())"
```

---

## üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–õ–æ–≥–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤:
- Systemd: `journalctl -u x0tta6bl4-bot`
- Cron jobs: `logs/backup.log`, `logs/expired_check.log`, `logs/health_check.log`

---

## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ

1. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–æ—Ç–∞: `systemctl stop x0tta6bl4-bot`
2. –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–¥
3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: `pip3 install -r requirements_bot.txt`
4. –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞: `systemctl start x0tta6bl4-bot`

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö:
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å health check: `python3 health_check.py`
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏: `journalctl -u x0tta6bl4-bot -f`
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö: `sqlite3 x0tta6bl4_users.db "SELECT COUNT(*) FROM users;"`

---

**–í–µ—Ä—Å–∏—è:** 1.0  
**–î–∞—Ç–∞:** 2025-01-XX

