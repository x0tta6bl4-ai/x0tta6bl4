# ะกัะตะฝะฐัะธะน 2: Telegram Bot โ Node Launch โ Status

**ะะฐัะฐ**: 2025-12-25  
**ะกัะฐััั**: โ **ะะะะะะะะะะะ**

---

## ๐ ะฆะตะปั

ะะตะฐะปะธะทะพะฒะฐัั user journey ัะตัะตะท Telegram Bot:
1. ะะพะปัะทะพะฒะฐัะตะปั ะทะฐะฟััะบะฐะตั ัะทะตะป ัะตัะตะท `/launch`
2. ะะพะปัะทะพะฒะฐัะตะปั ะฟะพะปััะฐะตั ััะฐััั ัะตัะธ ัะตัะตะท `/status`
3. ะะพะปัะทะพะฒะฐัะตะปั ะทะฐะบััะฒะฐะตั ัะพะตะดะธะฝะตะฝะธะต ัะตัะตะท `/close` (Tor-like)

---

## โ ะะตะฐะปะธะทะพะฒะฐะฝะฝัะต ะบะพะผะฟะพะฝะตะฝัั

### 1. NodeManagerService (`src/services/node_manager_service.py`)

**ะคัะฝะบัะธะธ**:
- โ `launch_node(user_id)` - ะทะฐะฟััะบ ัะทะปะฐ ะดะปั ะฟะพะปัะทะพะฒะฐัะตะปั
- โ `get_network_status(user_id)` - ะฟะพะปััะตะฝะธะต ััะฐัััะฐ ัะตัะธ
- โ `close_connection(user_id, connection_id)` - ะทะฐะบัััะธะต ัะพะตะดะธะฝะตะฝะธั
- โ `stop_node(user_id)` - ะพััะฐะฝะพะฒะบะฐ ัะทะปะฐ
- โ `get_global_status()` - ะณะปะพะฑะฐะปัะฝัะน ััะฐััั (ะดะปั ะฐะดะผะธะฝะพะฒ)

**ะัะพะฑะตะฝะฝะพััะธ**:
- ะฃะฝะธะบะฐะปัะฝัะน `node_id` ะดะปั ะบะฐะถะดะพะณะพ ะฟะพะปัะทะพะฒะฐัะตะปั
- ะะฒัะพะผะฐัะธัะตัะบะธะน ะฒัะฑะพั ัะฒะพะฑะพะดะฝะพะณะพ ะฟะพััะฐ
- ะฃะฟัะฐะฒะปะตะฝะธะต ัะพะตะดะธะฝะตะฝะธัะผะธ (Tor-like circuits)
- ะะฝัะตะณัะฐัะธั ั `CompleteMeshNode`

### 2. Telegram Bot Commands (`src/sales/telegram_bot.py`)

**ะะพะฒัะต ะบะพะผะฐะฝะดั**:
- โ `/launch` - ะทะฐะฟัััะธัั ัะทะตะป
- โ `/status` - ะฟะพะปััะธัั ััะฐััั ัะตัะธ
- โ `/close [connection_id]` - ะทะฐะบัััั ัะพะตะดะธะฝะตะฝะธะต

**ะคะพัะผะฐั ะพัะฒะตัะพะฒ**:
- Markdown ัะพัะผะฐัะธัะพะฒะฐะฝะธะต
- ะะตัะฐะปัะฝะฐั ะธะฝัะพัะผะฐัะธั ะพ ัะทะปะต, peers, routes, connections
- ะะฑัะฐะฑะพัะบะฐ ะพัะธะฑะพะบ

---

## ๐งช ะขะตััั

**ะคะฐะนะป**: `tests/integration/test_scenario2_telegram_bot.py`

**ะะพะบัััะธะต**:
- โ ะฃัะฟะตัะฝัะน ะทะฐะฟััะบ ัะทะปะฐ
- โ ะะฐะฟััะบ ัะถะต ะทะฐะฟััะตะฝะฝะพะณะพ ัะทะปะฐ
- โ ะะพะปััะตะฝะธะต ััะฐัััะฐ ัะตัะธ
- โ ะะพะปััะตะฝะธะต ััะฐัััะฐ ะฑะตะท ะทะฐะฟััะตะฝะฝะพะณะพ ัะทะปะฐ
- โ ะะฐะบัััะธะต ะฒัะตั ัะพะตะดะธะฝะตะฝะธะน
- โ ะะฐะบัััะธะต ะบะพะฝะบัะตัะฝะพะณะพ ัะพะตะดะธะฝะตะฝะธั
- โ ะะฐะบัััะธะต ะฟัะธ ะพััััััะฒะธะธ ัะพะตะดะธะฝะตะฝะธะน
- โ ะััะฐะฝะพะฒะบะฐ ัะทะปะฐ
- โ ะะปะพะฑะฐะปัะฝัะน ััะฐััั
- โ ะะตะทะฐะฒะธัะธะผะพััั ัะทะปะพะฒ ัะฐะทะฝัั ะฟะพะปัะทะพะฒะฐัะตะปะตะน
- โ Bootstrap nodes

**ะะตะทัะปััะฐั**: 11 ัะตััะพะฒ, ะฒัะต ะฟัะพัะพะดัั โ

---

## ๐ ะัะธะผะตั ะธัะฟะพะปัะทะพะฒะฐะฝะธั

### 1. ะะฐะฟััะบ ัะทะปะฐ

```
ะะพะปัะทะพะฒะฐัะตะปั: /launch

ะะพั:
๐ ะฃะทะตะป ะทะฐะฟััะตะฝ!

โโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โ Node ID: user-12345-a1b2c3d4
๐ Port: 6000
๐ฅ Peers: 3
๐ Status: running

โโโโโโโโโโโโโโโโโโโโโโโโโโโโ

ะัะฟะพะปัะทัะน /status ะดะปั ะฟัะพะฒะตัะบะธ ัะตัะธ
ะัะฟะพะปัะทัะน /close ะดะปั ะทะฐะบัััะธั ัะพะตะดะธะฝะตะฝะธั
```

### 2. ะะพะปััะตะฝะธะต ััะฐัััะฐ

```
ะะพะปัะทะพะฒะฐัะตะปั: /status

ะะพั:
๐ ะกัะฐััั ัะตัะธ

โโโโโโโโโโโโโโโโโโโโโโโโโโโโ

๐ Node ID: user-12345-a1b2c3d4
๐ Port: 6000
๐ข Running: ะะฐ

โโโโโโโโโโโโโโโโโโโโโโโโโโโโ

๐ฅ Peers:
โข ะัะตะณะพ: 3
โข ะกะฟะธัะพะบ: peer-1, peer-2, peer-3

โโโโโโโโโโโโโโโโโโโโโโโโโโโโ

๐ฃ๏ธ Routes:
โข ะัะตะณะพ: 5
โข Destinations: dest-1, dest-2, dest-3

โโโโโโโโโโโโโโโโโโโโโโโโโโโโ

๐ Connections:
โข ะะบัะธะฒะฝัั: 2
โข ะัะตะณะพ: 2

โโโโโโโโโโโโโโโโโโโโโโโโโโโโ

ะัะฟะพะปัะทัะน /close ะดะปั ะทะฐะบัััะธั ัะพะตะดะธะฝะตะฝะธั
```

### 3. ะะฐะบัััะธะต ัะพะตะดะธะฝะตะฝะธั

```
ะะพะปัะทะพะฒะฐัะตะปั: /close

ะะพั:
โ ะัะต ัะพะตะดะธะฝะตะฝะธั ะทะฐะบัััั

โโโโโโโโโโโโโโโโโโโโโโโโโโโโ

๐ ะะฐะบัััะพ: 2 ัะพะตะดะธะฝะตะฝะธะต(ะน)
๐ IDs: conn-1, conn-2

โโโโโโโโโโโโโโโโโโโโโโโโโโโโ

ะัะฟะพะปัะทัะน /status ะดะปั ะฟัะพะฒะตัะบะธ ัะตัะธ
```

---

## ๐ง ะขะตัะฝะธัะตัะบะธะต ะดะตัะฐะปะธ

### ะััะธัะตะบัััะฐ

```
Telegram Bot
    โ
NodeManagerService (singleton)
    โ
CompleteMeshNode (per user)
    โ
MeshRouter + MeshDiscovery + Transport
```

### ะฃะฟัะฐะฒะปะตะฝะธะต ัะพััะพัะฝะธะตะผ

- **User Nodes**: `Dict[int, UserNode]` - ัะทะปั ะฟะพะปัะทะพะฒะฐัะตะปะตะน
- **Connections**: `Dict[str, Dict]` - ะฐะบัะธะฒะฝัะต ัะพะตะดะธะฝะตะฝะธั (Tor-like circuits)
- **Port Management**: ะฐะฒัะพะผะฐัะธัะตัะบะธะน ะฒัะฑะพั ัะฒะพะฑะพะดะฝะพะณะพ ะฟะพััะฐ

### ะะฝัะตะณัะฐัะธั ั Mesh Network

- ะัะฟะพะปัะทัะตั `CompleteMeshNode` ะดะปั ะฟะพะปะฝะพะน ััะฝะบัะธะพะฝะฐะปัะฝะพััะธ
- ะะพะดะดะตัะถะบะฐ bootstrap nodes
- ะะฒัะพะผะฐัะธัะตัะบะพะต ะพะฑะฝะฐััะถะตะฝะธะต peers
- ะะฐัััััะธะทะฐัะธั ัะตัะตะท `MeshRouter`

---

## ๐ ะะตััะธะบะธ ััะฟะตัะฐ

| ะะตััะธะบะฐ | ะฆะตะปั | ะกัะฐััั |
|---------|------|--------|
| ะะพะผะฐะฝะดะฐ /launch ัะฐะฑะพัะฐะตั | โ | โ |
| ะะพะผะฐะฝะดะฐ /status ัะฐะฑะพัะฐะตั | โ | โ |
| ะะพะผะฐะฝะดะฐ /close ัะฐะฑะพัะฐะตั | โ | โ |
| ะะฝัะตะณัะฐัะธั ั mesh network | โ | โ |
| ะขะตััั ะฟัะพัะพะดัั | โ | โ |
| ะะฑัะฐะฑะพัะบะฐ ะพัะธะฑะพะบ | โ | โ |

---

## ๐ ะกะปะตะดัััะธะต ัะฐะณะธ

1. **ะะฝัะตะณัะฐัะธั ั ัะตะฐะปัะฝัะผ Telegram Bot**:
   - ะะฐัััะพะธัั `TELEGRAM_BOT_TOKEN`
   - ะัะพัะตััะธัะพะฒะฐัั ะฝะฐ ัะตะฐะปัะฝะพะผ ะฑะพัะต

2. **ะฃะปัััะตะฝะธั**:
   - ะะพะฑะฐะฒะธัั ะบะพะผะฐะฝะดั `/list_connections` ะดะปั ัะฟะธัะบะฐ ัะพะตะดะธะฝะตะฝะธะน
   - ะะพะฑะฐะฒะธัั ะบะพะผะฐะฝะดั `/restart` ะดะปั ะฟะตัะตะทะฐะฟััะบะฐ ัะทะปะฐ
   - ะะพะฑะฐะฒะธัั ะฐะดะผะธะฝัะบะธะต ะบะพะผะฐะฝะดั ะดะปั ะผะพะฝะธัะพัะธะฝะณะฐ

3. **Production ะณะพัะพะฒะฝะพััั**:
   - ะะพะฑะฐะฒะธัั rate limiting ะดะปั ะบะพะผะฐะฝะด
   - ะะพะฑะฐะฒะธัั ะปะพะณะธัะพะฒะฐะฝะธะต ะดะตะนััะฒะธะน ะฟะพะปัะทะพะฒะฐัะตะปะตะน
   - ะะพะฑะฐะฒะธัั ะผะตััะธะบะธ Prometheus

---

## โ ะกัะฐััั: ะะะะะะจะะะ

**ะัะต ะทะฐะดะฐัะธ ะฒัะฟะพะปะฝะตะฝั**:
- โ ะะพะผะฐะฝะดะฐ /launch ัะตะฐะปะธะทะพะฒะฐะฝะฐ
- โ ะะพะผะฐะฝะดะฐ /status ัะตะฐะปะธะทะพะฒะฐะฝะฐ
- โ ะะพะผะฐะฝะดะฐ /close ัะตะฐะปะธะทะพะฒะฐะฝะฐ
- โ ะะฝัะตะณัะฐัะธั ั mesh network
- โ End-to-end ัะตััั ัะพะทะดะฐะฝั

**ะกัะตะฝะฐัะธะน 2 ะณะพัะพะฒ ะบ ะธัะฟะพะปัะทะพะฒะฐะฝะธั!** ๐

